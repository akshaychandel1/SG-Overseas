{"ast":null,"code":"import _objectSpread from\"/Users/akshaychandel/Desktop/Grocerryadminfrontend-main/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// // // import React, { useEffect, useState } from \"react\";\n// // // import axios from \"axios\";\n// // // import {\n// // //   Chart as ChartJS,\n// // //   CategoryScale,\n// // //   LinearScale,\n// // //   PointElement,\n// // //   LineElement,\n// // //   Title,\n// // //   Tooltip,\n// // //   Legend,\n// // // } from \"chart.js\";\n// // // import { Line } from \"react-chartjs-2\";\n// // // import \"./PriceAnalytics.css\";\n// // // ChartJS.register(\n// // //   CategoryScale,\n// // //   LinearScale,\n// // //   PointElement,\n// // //   LineElement,\n// // //   Title,\n// // //   Tooltip,\n// // //   Legend\n// // // );\n// // // const API_BASE = \"https://grocerrybackend.onrender.com/api\";\n// // // const PriceAnalytics = () => {\n// // //   const [loading, setLoading] = useState(true);\n// // //   const [productList, setProductList] = useState([]);\n// // //   const [categoryList, setCategoryList] = useState([]);\n// // //   const [selectedProduct, setSelectedProduct] = useState(\"\");\n// // //   const [selectedCategory, setSelectedCategory] = useState(\"\");\n// // //   const [startDate, setStartDate] = useState(\"\");\n// // //   const [endDate, setEndDate] = useState(\"\");\n// // //   const [chartData, setChartData] = useState(null);\n// // //   // üîπ Fetch dropdowns\n// // //   useEffect(() => {\n// // //     const fetchDropdowns = async () => {\n// // //       try {\n// // //         const [products, categories] = await Promise.all([\n// // //           axios.get(`${API_BASE}/prices`),\n// // //           axios.get(`${API_BASE}/categories`),\n// // //         ]);\n// // //         setProductList(products.data.data || []);\n// // //         setCategoryList(categories.data.categories || []);\n// // //       } catch (err) {\n// // //         console.error(\"Dropdown fetch error:\", err);\n// // //       }\n// // //     };\n// // //     fetchDropdowns();\n// // //   }, []);\n// // //   // üîπ Fetch chart data with date filter\n// // //   const fetchChart = async () => {\n// // //     setLoading(true);\n// // //     try {\n// // //       const res = await axios.get(`${API_BASE}/prices`);\n// // //       const allPrices = res.data.data || [];\n// // //       // ‚úÖ Filter by Product / Category\n// // //       let filtered = allPrices;\n// // //       if (selectedProduct)\n// // //         filtered = filtered.filter((p) => p.name === selectedProduct);\n// // //       if (selectedCategory)\n// // //         filtered = filtered.filter(\n// // //           (p) => p.category?.name === selectedCategory\n// // //         );\n// // //       // ‚úÖ Filter by Date Range\n// // //       if (startDate && endDate) {\n// // //         const start = new Date(startDate);\n// // //         const end = new Date(endDate);\n// // //         filtered = filtered.filter((item) => {\n// // //           const date = new Date(item.validTill || item.createdAt);\n// // //           return date >= start && date <= end;\n// // //         });\n// // //       }\n// // //       // ‚úÖ Group by Date\n// // //       const groupedByDate = {};\n// // //       filtered.forEach((item) => {\n// // //         const dateKey = new Date(\n// // //           item.validTill || item.createdAt\n// // //         ).toLocaleDateString(\"en-IN\");\n// // //         if (!groupedByDate[dateKey]) groupedByDate[dateKey] = [];\n// // //         groupedByDate[dateKey].push(item);\n// // //       });\n// // //       const labels = Object.keys(groupedByDate);\n// // //       const avgBasePrice = labels.map((d) => {\n// // //         const dayData = groupedByDate[d];\n// // //         return (\n// // //           dayData.reduce((sum, i) => sum + Number(i.basePrice || 0), 0) /\n// // //           dayData.length\n// // //         );\n// // //       });\n// // //       const avgDiff = labels.map((d) => {\n// // //         const dayData = groupedByDate[d];\n// // //         return (\n// // //           dayData.reduce((sum, i) => sum + Number(i.difference || 0), 0) /\n// // //           dayData.length\n// // //         );\n// // //       });\n// // //       const totalCount = labels.map((d) => groupedByDate[d].length);\n// // //       // üîπ Multiple Line Datasets\n// // //       setChartData({\n// // //         labels,\n// // //         datasets: [\n// // //           {\n// // //             label: \"Average Base Price (‚Çπ)\",\n// // //             data: avgBasePrice,\n// // //             borderColor: \"#007bff\",\n// // //             backgroundColor: \"rgba(0,123,255,0.3)\",\n// // //             tension: 0.3,\n// // //             fill: false,\n// // //           },\n// // //           {\n// // //             label: \"Average Difference (‚Çπ)\",\n// // //             data: avgDiff,\n// // //             borderColor: \"#ffc107\",\n// // //             backgroundColor: \"rgba(255,193,7,0.3)\",\n// // //             tension: 0.3,\n// // //             fill: false,\n// // //           },\n// // //           {\n// // //             label: \"Total Products Count\",\n// // //             data: totalCount,\n// // //             borderColor: \"#28a745\",\n// // //             backgroundColor: \"rgba(40,167,69,0.3)\",\n// // //             tension: 0.3,\n// // //             fill: false,\n// // //           },\n// // //         ],\n// // //       });\n// // //     } catch (err) {\n// // //       console.error(\"Chart fetch error:\", err);\n// // //     } finally {\n// // //       setLoading(false);\n// // //     }\n// // //   };\n// // //   useEffect(() => {\n// // //     fetchChart();\n// // //   }, [selectedProduct, selectedCategory, startDate, endDate]);\n// // //   return (\n// // //     <div className=\"analytics-container\">\n// // //       <h2 className=\"analytics-title\">üìÖ Price History & Analytics</h2>\n// // //       <p className=\"analytics-subtitle\">\n// // //         Track your product & category price trends over time\n// // //       </p>\n// // //       {/* Filters */}\n// // //       <div className=\"filter-section\">\n// // //         <div className=\"filter-group\">\n// // //           <label>üßÉ Product:</label>\n// // //           <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\n// // //             <option value=\"\">All Products</option>\n// // //             {productList.map((p) => (\n// // //               <option key={p._id} value={p.name}>{p.name}</option>\n// // //             ))}\n// // //           </select>\n// // //         </div>\n// // //         <div className=\"filter-group\">\n// // //           <label>üóÇÔ∏è Category:</label>\n// // //           <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\n// // //             <option value=\"\">All Categories</option>\n// // //             {categoryList.map((c) => (\n// // //               <option key={c._id} value={c.name}>{c.name}</option>\n// // //             ))}\n// // //           </select>\n// // //         </div>\n// // //         <div className=\"filter-group\">\n// // //           <label>üìÜ From:</label>\n// // //           <input type=\"date\" value={startDate} onChange={(e) => setStartDate(e.target.value)} />\n// // //         </div>\n// // //         <div className=\"filter-group\">\n// // //           <label>‚û° To:</label>\n// // //           <input type=\"date\" value={endDate} onChange={(e) => setEndDate(e.target.value)} />\n// // //         </div>\n// // //         <button className=\"btn refresh\" onClick={fetchChart}>üîÑ Apply</button>\n// // //       </div>\n// // //       {/* Chart */}\n// // //       <div className=\"chart-wrapper\">\n// // //         {loading ? (\n// // //           <div className=\"loading\">Loading chart...</div>\n// // //         ) : chartData ? (\n// // //           <Line\n// // //             data={chartData}\n// // //             options={{\n// // //               responsive: true,\n// // //               maintainAspectRatio: false,\n// // //               plugins: {\n// // //                 legend: { position: \"bottom\" },\n// // //               },\n// // //               scales: {\n// // //                 y: { beginAtZero: true },\n// // //               },\n// // //             }}\n// // //           />\n// // //         ) : (\n// // //           <div className=\"no-data\">No data found.</div>\n// // //         )}\n// // //       </div>\n// // //     </div>\n// // //   );\n// // // };\n// // // export default PriceAnalytics;\n// // import React, { useEffect, useState } from \"react\";\n// // import axios from \"axios\";\n// // import {\n// //   Chart as ChartJS,\n// //   CategoryScale,\n// //   LinearScale,\n// //   PointElement,\n// //   LineElement,\n// //   Title,\n// //   Tooltip,\n// //   Legend,\n// // } from \"chart.js\";\n// // import ChartDataLabels from \"chartjs-plugin-datalabels\";\n// // import { Line } from \"react-chartjs-2\";\n// // import \"./PriceAnalytics.css\";\n// // ChartJS.register(\n// //   CategoryScale,\n// //   LinearScale,\n// //   PointElement,\n// //   LineElement,\n// //   Title,\n// //   Tooltip,\n// //   Legend,\n// //   ChartDataLabels\n// // );\n// // const API_BASE = \"https://grocerrybackend.onrender.com/api\";\n// // const PriceAnalytics = () => {\n// //   const [loading, setLoading] = useState(true);\n// //   const [productList, setProductList] = useState([]);\n// //   const [categoryList, setCategoryList] = useState([]);\n// //   const [selectedProduct, setSelectedProduct] = useState(\"\");\n// //   const [selectedCategory, setSelectedCategory] = useState(\"\");\n// //   const [chartData, setChartData] = useState(null);\n// //   useEffect(() => {\n// //     const fetchDropdowns = async () => {\n// //       try {\n// //         const [p, c] = await Promise.all([\n// //           axios.get(`${API_BASE}/prices`),\n// //           axios.get(`${API_BASE}/categories`),\n// //         ]);\n// //         setProductList(p.data.data || []);\n// //         setCategoryList(c.data.categories || []);\n// //       } catch (err) {\n// //         console.error(\"Dropdown fetch error:\", err);\n// //       }\n// //     };\n// //     fetchDropdowns();\n// //   }, []);\n// //   const fetchChart = async () => {\n// //     setLoading(true);\n// //     try {\n// //       const res = await axios.get(`${API_BASE}/prices`);\n// //       let all = res.data.data || [];\n// //       // Filters\n// //       if (selectedProduct)\n// //         all = all.filter((p) => p.name === selectedProduct);\n// //       if (selectedCategory)\n// //         all = all.filter((p) => p.category?.name === selectedCategory);\n// //       // Group by Date\n// //       const grouped = {};\n// //       all.forEach((item) => {\n// //         const k = new Date(item.validTill || item.createdAt).toLocaleDateString(\"en-IN\");\n// //         if (!grouped[k]) grouped[k] = [];\n// //         grouped[k].push(item);\n// //       });\n// //       const labels = Object.keys(grouped);\n// //       // Final Price\n// //       const finalPrice = labels.map((d) => {\n// //         const arr = grouped[d];\n// //         return arr.reduce(\n// //           (sum, x) => sum + (Number(x.basePrice || 0) + Number(x.difference || 0)),\n// //           0\n// //         ) / arr.length;\n// //       });\n// //       setChartData({\n// //         labels,\n// //         datasets: [\n// //           {\n// //             label: \"Final Price (‚Çπ)\",\n// //             data: finalPrice,\n// //             borderColor: \"#007bff\",\n// //             backgroundColor: \"rgba(0,123,255,0.3)\",\n// //             tension: 0.3,\n// //           },\n// //         ],\n// //       });\n// //     } catch (err) {\n// //       console.error(\"Chart error:\", err);\n// //     } finally {\n// //       setLoading(false);\n// //     }\n// //   };\n// //   useEffect(() => {\n// //     fetchChart();\n// //   }, [selectedProduct, selectedCategory]);\n// //   return (\n// //     <div className=\"analytics-container\">\n// //       <h2 className=\"analytics-title\">üìä Final Price Analytics</h2>\n// //       {/* Filters */}\n// //       <div className=\"filter-section\">\n// //         <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\n// //           <option value=\"\">All Products</option>\n// //           {productList.map((p) => (\n// //             <option key={p._id} value={p.name}>{p.name}</option>\n// //           ))}\n// //         </select>\n// //         <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\n// //           <option value=\"\">All Categories</option>\n// //           {categoryList.map((c) => (\n// //             <option key={c._id} value={c.name}>{c.name}</option>\n// //           ))}\n// //         </select>\n// //         <button className=\"btn refresh\" onClick={fetchChart}>Apply</button>\n// //       </div>\n// //       {/* Chart */}\n// //       <div className=\"chart-wrapper\">\n// //         {loading ? (\n// //           <div className=\"loading\">Loading...</div>\n// //         ) : (\n// //           <Line\n// //             data={chartData}\n// //             options={{\n// //               responsive: true,\n// //               maintainAspectRatio: false,\n// //               plugins: {\n// //                 legend: { position: \"bottom\" },\n// //                 // ‚≠ê ALWAYS SHOW LABEL ‚≠ê\n// //                 datalabels: {\n// //                   color: \"#000\",\n// //                   anchor: \"end\",\n// //                   align: \"top\",\n// //                   formatter: (value) => `‚Çπ${value}`,\n// //                   font: {\n// //                     weight: \"bold\",\n// //                     size: 12,\n// //                   },\n// //                 },\n// //               },\n// //               scales: {\n// //                 y: { beginAtZero: true },\n// //               },\n// //             }}\n// //           />\n// //         )}\n// //       </div>\n// //     </div>\n// //   );\n// // };\n// // export default PriceAnalytics;\n// // import React, { useEffect, useState } from \"react\";\n// // import axios from \"axios\";\n// // import {\n// //   Chart as ChartJS,\n// //   CategoryScale,\n// //   LinearScale,\n// //   PointElement,\n// //   LineElement,\n// //   Title,\n// //   Tooltip,\n// //   Legend,\n// // } from \"chart.js\";\n// // import ChartDataLabels from \"chartjs-plugin-datalabels\";\n// // import { Line } from \"react-chartjs-2\";\n// // import \"./PriceAnalytics.css\";\n// // ChartJS.register(\n// //   CategoryScale,\n// //   LinearScale,\n// //   PointElement,\n// //   LineElement,\n// //   Title,\n// //   Tooltip,\n// //   Legend,\n// //   ChartDataLabels\n// // );\n// // const API_BASE = \"https://grocerrybackend.onrender.com/api\";\n// // const PriceAnalytics = () => {\n// //   const [loading, setLoading] = useState(true);\n// //   const [productList, setProductList] = useState([]);\n// //   const [categoryList, setCategoryList] = useState([]);\n// //   const [selectedProduct, setSelectedProduct] = useState(\"\");\n// //   const [selectedCategory, setSelectedCategory] = useState(\"\");\n// //   // NEW FILTER STATE\n// //   const [chartType, setChartType] = useState(\"daily\"); // daily, weekly, monthly, yearly, custom\n// //   const [startDate, setStartDate] = useState(\"\");\n// //   const [endDate, setEndDate] = useState(\"\");\n// //   const [chartData, setChartData] = useState(null);\n// //   useEffect(() => {\n// //     const fetchDropdowns = async () => {\n// //       try {\n// //         const [p, c] = await Promise.all([\n// //           axios.get(`${API_BASE}/prices`),\n// //           axios.get(`${API_BASE}/categories`),\n// //         ]);\n// //         setProductList(p.data.data || []);\n// //         setCategoryList(c.data.categories || []);\n// //       } catch (err) {\n// //         console.error(\"Dropdown fetch error:\", err);\n// //       }\n// //     };\n// //     fetchDropdowns();\n// //   }, []);\n// //   // üî• GROUPING HELPERS\n// //   const groupByWeek = (date) => {\n// //     const d = new Date(date);\n// //     const onejan = new Date(d.getFullYear(), 0, 1);\n// //     const week = Math.ceil(((d - onejan) / 86400000 + onejan.getDay() + 1) / 7);\n// //     return `Week ${week} - ${d.getFullYear()}`;\n// //   };\n// //   const groupByMonth = (date) => {\n// //     const d = new Date(date);\n// //     return `${d.toLocaleString(\"en-US\", { month: \"short\" })} ${d.getFullYear()}`;\n// //   };\n// //   const groupByYear = (date) => {\n// //     return new Date(date).getFullYear().toString();\n// //   };\n// //   const fetchChart = async () => {\n// //     setLoading(true);\n// //     try {\n// //       const res = await axios.get(`${API_BASE}/prices`);\n// //       let all = res.data.data || [];\n// //       // PRODUCT FILTER\n// //       if (selectedProduct)\n// //         all = all.filter((p) => p.name === selectedProduct);\n// //       // CATEGORY FILTER\n// //       if (selectedCategory)\n// //         all = all.filter((p) => p.category?.name === selectedCategory);\n// //       // RANGE FILTER\n// //       if (chartType === \"custom\" && startDate && endDate) {\n// //         const start = new Date(startDate);\n// //         const end = new Date(endDate);\n// //         all = all.filter((p) => {\n// //           const d = new Date(p.validTill || p.createdAt);\n// //           return d >= start && d <= end;\n// //         });\n// //       }\n// //       // GROUP DATA\n// //       const groups = {};\n// //       all.forEach((item) => {\n// //         const date = item.validTill || item.createdAt;\n// //         let groupKey = \"\";\n// //         switch (chartType) {\n// //           case \"weekly\":\n// //             groupKey = groupByWeek(date);\n// //             break;\n// //           case \"monthly\":\n// //             groupKey = groupByMonth(date);\n// //             break;\n// //           case \"yearly\":\n// //             groupKey = groupByYear(date);\n// //             break;\n// //           default:\n// //             groupKey = new Date(date).toLocaleDateString(\"en-IN\");\n// //         }\n// //         if (!groups[groupKey]) groups[groupKey] = [];\n// //         groups[groupKey].push(item);\n// //       });\n// //       const labels = Object.keys(groups);\n// //       const finalPriceAvg = labels.map((d) => {\n// //         const arr = groups[d];\n// //         return (\n// //           arr.reduce(\n// //             (sum, x) =>\n// //               sum + (Number(x.basePrice || 0) + Number(x.difference || 0)),\n// //             0\n// //           ) / arr.length\n// //         );\n// //       });\n// //       setChartData({\n// //         labels,\n// //         datasets: [\n// //           {\n// //             label: \"Final Price (‚Çπ)\",\n// //             data: finalPriceAvg,\n// //             borderColor: \"#007bff\",\n// //             backgroundColor: \"rgba(0,123,255,0.3)\",\n// //             tension: 0.3,\n// //           },\n// //         ],\n// //       });\n// //     } catch (err) {\n// //       console.error(\"Chart Error:\", err);\n// //     } finally {\n// //       setLoading(false);\n// //     }\n// //   };\n// //   useEffect(() => {\n// //     fetchChart();\n// //   }, [selectedProduct, selectedCategory, chartType, startDate, endDate]);\n// //   return (\n// //     <div className=\"analytics-container\">\n// //       <h2 className=\"analytics-title\">Price Analytics</h2>\n// //       <div className=\"filter-section\">\n// //         {/* PRODUCT */}\n// //         <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\n// //           <option value=\"\">All Products</option>\n// //           {productList.map((p) => (\n// //             <option key={p._id} value={p.name}>{p.name}</option>\n// //           ))}\n// //         </select>\n// //         {/* CATEGORY */}\n// //         <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\n// //           <option value=\"\">All Categories</option>\n// //           {categoryList.map((c) => (\n// //             <option key={c._id} value={c.name}>{c.name}</option>\n// //           ))}\n// //         </select>\n// //         {/* TYPE FILTER */}\n// //         <select value={chartType} onChange={(e) => setChartType(e.target.value)}>\n// //           <option value=\"daily\">Daily</option>\n// //           <option value=\"weekly\">Weekly</option>\n// //           <option value=\"monthly\">Monthly</option>\n// //           <option value=\"yearly\">Yearly</option>\n// //           {/* <option value=\"custom\">Custom Range</option> */}\n// //         </select>\n// //         {/* DATE RANGE ONLY IF CUSTOM */}\n// //         {chartType === \"custom\" && (\n// //           <>\n// //             <input type=\"date\" value={startDate} onChange={(e) => setStartDate(e.target.value)} />\n// //             <input type=\"date\" value={endDate} onChange={(e) => setEndDate(e.target.value)} />\n// //           </>\n// //         )}\n// //         {/* <button className=\"btn refresh\" onClick={fetchChart}>Apply</button> */}\n// //       </div>\n// //       <div className=\"chart-wrapper\">\n// //         {loading ? (\n// //           <div className=\"loading\">Loading chart...</div>\n// //         ) : (\n// //           <Line\n// //             data={chartData}\n// //             options={{\n// //               responsive: true,\n// //               maintainAspectRatio: false,\n// //               plugins: {\n// //                 legend: { position: \"bottom\" },\n// //                 datalabels: {\n// //                   color: \"black\",\n// //                   anchor: \"end\",\n// //                   align: \"top\",\n// //                   formatter: (v) => `‚Çπ${v}`,\n// //                   font: { size: 12, weight: \"bold\" },\n// //                 },\n// //               },\n// //             }}\n// //           />\n// //         )}\n// //       </div>\n// //     </div>\n// //   );\n// // };\n// // export default PriceAnalytics;\n// import React, { useEffect, useState } from \"react\";\n// import axios from \"axios\";\n// import {\n//   Chart as ChartJS,\n//   CategoryScale,\n//   LinearScale,\n//   PointElement,\n//   LineElement,\n//   Tooltip,\n//   Legend,\n// } from \"chart.js\";\n// import ChartDataLabels from \"chartjs-plugin-datalabels\";\n// import { Line } from \"react-chartjs-2\";\n// import \"./PriceAnalytics.css\";\n// ChartJS.register(\n//   CategoryScale,\n//   LinearScale,\n//   PointElement,\n//   LineElement,\n//   Tooltip,\n//   Legend,\n//   ChartDataLabels\n// );\n// const API_BASE = \"https://grocerrybackend.onrender.com/api\";\n// export default function PriceAnalytics() {\n//   const [loading, setLoading] = useState(true);\n//   const [productList, setProductList] = useState([]);\n//   const [categoryList, setCategoryList] = useState([]);\n//   const [selectedProduct, setSelectedProduct] = useState(\"\");\n//   const [selectedCategory, setSelectedCategory] = useState(\"\");\n//   const [chartData, setChartData] = useState(null);\n//   /* ================= DROPDOWNS ================= */\n//   useEffect(() => {\n//     Promise.all([\n//       axios.get(`${API_BASE}/prices`),\n//       axios.get(`${API_BASE}/categories`),\n//     ]).then(([p, c]) => {\n//       setProductList(p.data.data || []);\n//       setCategoryList(c.data.categories || []);\n//     });\n//   }, []);\n//   /* ================= ZIG-ZAG CHART ================= */\n//   const fetchChart = async () => {\n//     setLoading(true);\n//     try {\n//       const res = await axios.get(`${API_BASE}/prices`);\n//       let data = res.data.data || [];\n//       // FILTERS\n//       if (selectedProduct)\n//         data = data.filter((p) => p.name === selectedProduct);\n//       if (selectedCategory)\n//         data = data.filter((p) => p.category?.name === selectedCategory);\n//       // SORT BY TIME (VERY IMPORTANT)\n//       data.sort(\n//         (a, b) =>\n//           new Date(a.createdAt || a.validTill) -\n//           new Date(b.createdAt || b.validTill)\n//       );\n//       const labels = data.map((item) =>\n//         new Date(item.createdAt || item.validTill).toLocaleString(\"en-IN\")\n//       );\n//       const prices = data.map((item) => {\n//         const base = Number(item.basePrice) || 0;\n//         const diff = Number(item.difference) || 0;\n//         return base + diff;\n//       });\n//       // SINGLE POINT FIX\n//       if (labels.length === 1) {\n//         labels.unshift(\"Earlier\");\n//         prices.unshift(prices[0]);\n//       }\n//       setChartData({\n//         labels,\n//         datasets: [\n//           {\n//             label: \"Final Price (‚Çπ)\",\n//             data: prices,\n//             borderColor: \"#dc3545\",\n//             backgroundColor: \"rgba(220,53,69,0.15)\",\n//             tension: 0,           // üî• NO SMOOTH ‚Üí SHARP ZIG ZAG\n//             fill: true,\n//             pointRadius: 5,\n//             pointHoverRadius: 7,\n//           },\n//         ],\n//       });\n//     } catch (err) {\n//       console.error(\"Chart error:\", err);\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\n//   useEffect(() => {\n//     fetchChart();\n//   }, [selectedProduct, selectedCategory]);\n//   return (\n//     <div className=\"analytics-container\">\n//       <h2 className=\"analytics-title\">Price Analytics (Zig-Zag)</h2>\n//       <div className=\"filter-section\">\n//         <select onChange={(e) => setSelectedProduct(e.target.value)}>\n//           <option value=\"\">All Products</option>\n//           {productList.map((p) => (\n//             <option key={p._id} value={p.name}>{p.name}</option>\n//           ))}\n//         </select>\n//         <select onChange={(e) => setSelectedCategory(e.target.value)}>\n//           <option value=\"\">All Categories</option>\n//           {categoryList.map((c) => (\n//             <option key={c._id} value={c.name}>{c.name}</option>\n//           ))}\n//         </select>\n//       </div>\n//       <div className=\"chart-wrapper\">\n//         {loading ? (\n//           <div className=\"loading\">Loading...</div>\n//         ) : chartData ? (\n//           <Line\n//             data={chartData}\n//             options={{\n//               responsive: true,\n//               maintainAspectRatio: false,\n//               scales: {\n//                 y: { beginAtZero: false },\n//               },\n//               plugins: {\n//                 legend: { position: \"bottom\" },\n//                 datalabels: {\n//                   display: true,\n//                   align: \"top\",\n//                   formatter: (v) => `‚Çπ${v}`,\n//                   font: { weight: \"bold\" },\n//                 },\n//               },\n//             }}\n//           />\n//         ) : (\n//           <div className=\"no-data\">No data available</div>\n//         )}\n//       </div>\n//     </div>\n//   );\n// }\nimport React,{useEffect,useState}from\"react\";import axios from\"axios\";import{Chart as ChartJS,CategoryScale,LinearScale,PointElement,LineElement,Tooltip,Legend}from\"chart.js\";import ChartDataLabels from\"chartjs-plugin-datalabels\";import{Line}from\"react-chartjs-2\";import\"./PriceAnalytics.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";ChartJS.register(CategoryScale,LinearScale,PointElement,LineElement,Tooltip,Legend,ChartDataLabels);const API_BASE=\"https://grocerrybackend.onrender.com/api\";export default function PriceAnalytics(){const[loading,setLoading]=useState(true);const[productList,setProductList]=useState([]);const[categoryList,setCategoryList]=useState([]);const[selectedProduct,setSelectedProduct]=useState(\"\");const[selectedCategory,setSelectedCategory]=useState(\"\");const[chartData,setChartData]=useState(null);/* ================= LOAD DROPDOWNS ================= */useEffect(()=>{Promise.all([axios.get(\"\".concat(API_BASE,\"/prices\")),axios.get(\"\".concat(API_BASE,\"/categories\"))]).then(_ref=>{let[priceRes,catRes]=_ref;// üî• Extract ONLY PRODUCTS from nested structure\nconst products=[];// priceRes.data.data.forEach(category => {\n//   category.subcategories.forEach(sub => {\n//     sub.products.forEach(prod => {\n//       products.push(prod);\n//     });\n//   });\n// });\npriceRes.data.data.forEach(category=>{category.subcategories.forEach(sub=>{sub.products.forEach(prod=>{products.push(_objectSpread(_objectSpread({},prod),{},{categoryName:category.name// üî• attach category\n}));});});});setProductList(products);setCategoryList(catRes.data.categories||[]);});},[]);/* ================= FETCH CHART ================= *///   const fetchChart = async () => {\n//     setLoading(true);\n//     try {\n//       const res = await axios.get(`${API_BASE}/prices`);\n//       let data = [];\n//       // üî• Flatten Category ‚Üí Sub ‚Üí Products\n//       // res.data.data.forEach(category => {\n//       //   category.subcategories.forEach(sub => {\n//       //     sub.products.forEach(prod => {\n//       //       data.push(prod);\n//       //     });\n//       //   });\n//       // });\n//       priceRes.data.data.forEach(category => {\n//   category.subcategories.forEach(sub => {\n//     sub.products.forEach(prod => {\n//       products.push({\n//         ...prod,\n//         categoryName: category.name   // üî• attach category\n//       });\n//     });\n//   });\n// });\n//       // üî• Filters\n//       if (selectedProduct) {\n//         data = data.filter(p => p.name === selectedProduct);\n//       }\n//       // if (selectedCategory) {\n//       //   data = data.filter(p => p.category?.name === selectedCategory);\n//       // }\n//       // üî• Sort by time\n//       data.sort(\n//         (a, b) =>\n//           new Date(a.createdAt || a.validTill) -\n//           new Date(b.createdAt || b.validTill)\n//       );\n//       const labels = data.map(item =>\n//         new Date(item.createdAt || item.validTill).toLocaleString(\"en-IN\")\n//       );\n//       const prices = data.map(item => {\n//         const base = Number(item.basePrice) || 0;\n//         const diff = Number(item.difference) || 0;\n//         return base + diff;\n//       });\n//       // Single point fix\n//       if (labels.length === 1) {\n//         labels.unshift(\"Earlier\");\n//         prices.unshift(prices[0]);\n//       }\n//       setChartData({\n//         labels,\n//         datasets: [\n//           {\n//             label: \"Final Price (‚Çπ)\",\n//             data: prices,\n//             borderColor: \"#dc3545\",\n//             backgroundColor: \"rgba(220,53,69,0.15)\",\n//             tension: 0,\n//             fill: true,\n//             pointRadius: 5,\n//             pointHoverRadius: 7,\n//           },\n//         ],\n//       });\n//     } catch (err) {\n//       console.error(\"Chart error:\", err);\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\nconst fetchChart=async()=>{setLoading(true);try{const res=await axios.get(\"\".concat(API_BASE,\"/prices\"));let data=[];// ‚úÖ Proper flatten with category name\nres.data.data.forEach(category=>{category.subcategories.forEach(sub=>{sub.products.forEach(prod=>{data.push(_objectSpread(_objectSpread({},prod),{},{categoryName:category.name// üî• important\n}));});});});// ‚úÖ Product filter\nif(selectedProduct){data=data.filter(p=>p.name===selectedProduct);}// ‚úÖ Category filter\nif(selectedCategory){data=data.filter(p=>p.categoryName===selectedCategory);}// ‚ùó If nothing found, clear chart\nif(data.length===0){setChartData(null);setLoading(false);return;}// ‚úÖ Sort by time\ndata.sort((a,b)=>new Date(a.createdAt||a.validTill)-new Date(b.createdAt||b.validTill));const labels=data.map(item=>new Date(item.createdAt||item.validTill).toLocaleString(\"en-IN\"));const prices=data.map(item=>{const base=Number(item.basePrice)||0;const diff=Number(item.difference)||0;return base+diff;});// Single point zigzag fix\nif(labels.length===1){labels.unshift(\"Earlier\");prices.unshift(prices[0]);}setChartData({labels,datasets:[{label:\"Final Price (‚Çπ)\",data:prices,borderColor:\"#dc3545\",backgroundColor:\"rgba(220,53,69,0.15)\",tension:0,fill:true,pointRadius:5,pointHoverRadius:7}]});}catch(err){console.error(\"Chart error:\",err);}finally{setLoading(false);}};useEffect(()=>{fetchChart();},[selectedProduct,selectedCategory]);/* ================= UI ================= */return/*#__PURE__*/_jsxs(\"div\",{className:\"analytics-container\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"analytics-title\",children:\"Price Analytics (Zig-Zag)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-section\",children:[/*#__PURE__*/_jsxs(\"select\",{value:selectedProduct,onChange:e=>setSelectedProduct(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Products\"}),productList.map(p=>/*#__PURE__*/_jsx(\"option\",{value:p.name,children:p.name},p._id))]}),/*#__PURE__*/_jsxs(\"select\",{value:selectedCategory,onChange:e=>setSelectedCategory(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Categories\"}),categoryList.map(c=>/*#__PURE__*/_jsx(\"option\",{value:c.name,children:c.name},c._id))]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chart-wrapper\",children:loading?/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading...\"}):chartData?/*#__PURE__*/_jsx(Line,{data:chartData,options:{responsive:true,maintainAspectRatio:false,scales:{y:{beginAtZero:false}},plugins:{legend:{position:\"bottom\"},datalabels:{display:true,align:\"top\",formatter:v=>\"\\u20B9\".concat(v),font:{weight:\"bold\"}}}}}):/*#__PURE__*/_jsx(\"div\",{className:\"no-data\",children:\"No data available\"})})]});}","map":{"version":3,"names":["React","useEffect","useState","axios","Chart","ChartJS","CategoryScale","LinearScale","PointElement","LineElement","Tooltip","Legend","ChartDataLabels","Line","jsx","_jsx","jsxs","_jsxs","register","API_BASE","PriceAnalytics","loading","setLoading","productList","setProductList","categoryList","setCategoryList","selectedProduct","setSelectedProduct","selectedCategory","setSelectedCategory","chartData","setChartData","Promise","all","get","concat","then","_ref","priceRes","catRes","products","data","forEach","category","subcategories","sub","prod","push","_objectSpread","categoryName","name","categories","fetchChart","res","filter","p","length","sort","a","b","Date","createdAt","validTill","labels","map","item","toLocaleString","prices","base","Number","basePrice","diff","difference","unshift","datasets","label","borderColor","backgroundColor","tension","fill","pointRadius","pointHoverRadius","err","console","error","className","children","value","onChange","e","target","_id","c","options","responsive","maintainAspectRatio","scales","y","beginAtZero","plugins","legend","position","datalabels","display","align","formatter","v","font","weight"],"sources":["/Users/akshaychandel/Desktop/Grocerryadminfrontend-main/src/pages/admin/PriceAnalytics.jsx"],"sourcesContent":["\r\n\r\n// // // import React, { useEffect, useState } from \"react\";\r\n// // // import axios from \"axios\";\r\n// // // import {\r\n// // //   Chart as ChartJS,\r\n// // //   CategoryScale,\r\n// // //   LinearScale,\r\n// // //   PointElement,\r\n// // //   LineElement,\r\n// // //   Title,\r\n// // //   Tooltip,\r\n// // //   Legend,\r\n// // // } from \"chart.js\";\r\n// // // import { Line } from \"react-chartjs-2\";\r\n// // // import \"./PriceAnalytics.css\";\r\n\r\n// // // ChartJS.register(\r\n// // //   CategoryScale,\r\n// // //   LinearScale,\r\n// // //   PointElement,\r\n// // //   LineElement,\r\n// // //   Title,\r\n// // //   Tooltip,\r\n// // //   Legend\r\n// // // );\r\n\r\n// // // const API_BASE = \"https://grocerrybackend.onrender.com/api\";\r\n\r\n// // // const PriceAnalytics = () => {\r\n// // //   const [loading, setLoading] = useState(true);\r\n// // //   const [productList, setProductList] = useState([]);\r\n// // //   const [categoryList, setCategoryList] = useState([]);\r\n// // //   const [selectedProduct, setSelectedProduct] = useState(\"\");\r\n// // //   const [selectedCategory, setSelectedCategory] = useState(\"\");\r\n// // //   const [startDate, setStartDate] = useState(\"\");\r\n// // //   const [endDate, setEndDate] = useState(\"\");\r\n// // //   const [chartData, setChartData] = useState(null);\r\n\r\n// // //   // üîπ Fetch dropdowns\r\n// // //   useEffect(() => {\r\n// // //     const fetchDropdowns = async () => {\r\n// // //       try {\r\n// // //         const [products, categories] = await Promise.all([\r\n// // //           axios.get(`${API_BASE}/prices`),\r\n// // //           axios.get(`${API_BASE}/categories`),\r\n// // //         ]);\r\n// // //         setProductList(products.data.data || []);\r\n// // //         setCategoryList(categories.data.categories || []);\r\n// // //       } catch (err) {\r\n// // //         console.error(\"Dropdown fetch error:\", err);\r\n// // //       }\r\n// // //     };\r\n// // //     fetchDropdowns();\r\n// // //   }, []);\r\n\r\n// // //   // üîπ Fetch chart data with date filter\r\n// // //   const fetchChart = async () => {\r\n// // //     setLoading(true);\r\n// // //     try {\r\n// // //       const res = await axios.get(`${API_BASE}/prices`);\r\n// // //       const allPrices = res.data.data || [];\r\n\r\n// // //       // ‚úÖ Filter by Product / Category\r\n// // //       let filtered = allPrices;\r\n// // //       if (selectedProduct)\r\n// // //         filtered = filtered.filter((p) => p.name === selectedProduct);\r\n// // //       if (selectedCategory)\r\n// // //         filtered = filtered.filter(\r\n// // //           (p) => p.category?.name === selectedCategory\r\n// // //         );\r\n\r\n// // //       // ‚úÖ Filter by Date Range\r\n// // //       if (startDate && endDate) {\r\n// // //         const start = new Date(startDate);\r\n// // //         const end = new Date(endDate);\r\n\r\n// // //         filtered = filtered.filter((item) => {\r\n// // //           const date = new Date(item.validTill || item.createdAt);\r\n// // //           return date >= start && date <= end;\r\n// // //         });\r\n// // //       }\r\n\r\n// // //       // ‚úÖ Group by Date\r\n// // //       const groupedByDate = {};\r\n// // //       filtered.forEach((item) => {\r\n// // //         const dateKey = new Date(\r\n// // //           item.validTill || item.createdAt\r\n// // //         ).toLocaleDateString(\"en-IN\");\r\n\r\n// // //         if (!groupedByDate[dateKey]) groupedByDate[dateKey] = [];\r\n// // //         groupedByDate[dateKey].push(item);\r\n// // //       });\r\n\r\n// // //       const labels = Object.keys(groupedByDate);\r\n\r\n// // //       const avgBasePrice = labels.map((d) => {\r\n// // //         const dayData = groupedByDate[d];\r\n// // //         return (\r\n// // //           dayData.reduce((sum, i) => sum + Number(i.basePrice || 0), 0) /\r\n// // //           dayData.length\r\n// // //         );\r\n// // //       });\r\n\r\n// // //       const avgDiff = labels.map((d) => {\r\n// // //         const dayData = groupedByDate[d];\r\n// // //         return (\r\n// // //           dayData.reduce((sum, i) => sum + Number(i.difference || 0), 0) /\r\n// // //           dayData.length\r\n// // //         );\r\n// // //       });\r\n\r\n// // //       const totalCount = labels.map((d) => groupedByDate[d].length);\r\n\r\n// // //       // üîπ Multiple Line Datasets\r\n// // //       setChartData({\r\n// // //         labels,\r\n// // //         datasets: [\r\n// // //           {\r\n// // //             label: \"Average Base Price (‚Çπ)\",\r\n// // //             data: avgBasePrice,\r\n// // //             borderColor: \"#007bff\",\r\n// // //             backgroundColor: \"rgba(0,123,255,0.3)\",\r\n// // //             tension: 0.3,\r\n// // //             fill: false,\r\n// // //           },\r\n// // //           {\r\n// // //             label: \"Average Difference (‚Çπ)\",\r\n// // //             data: avgDiff,\r\n// // //             borderColor: \"#ffc107\",\r\n// // //             backgroundColor: \"rgba(255,193,7,0.3)\",\r\n// // //             tension: 0.3,\r\n// // //             fill: false,\r\n// // //           },\r\n// // //           {\r\n// // //             label: \"Total Products Count\",\r\n// // //             data: totalCount,\r\n// // //             borderColor: \"#28a745\",\r\n// // //             backgroundColor: \"rgba(40,167,69,0.3)\",\r\n// // //             tension: 0.3,\r\n// // //             fill: false,\r\n// // //           },\r\n// // //         ],\r\n// // //       });\r\n// // //     } catch (err) {\r\n// // //       console.error(\"Chart fetch error:\", err);\r\n// // //     } finally {\r\n// // //       setLoading(false);\r\n// // //     }\r\n// // //   };\r\n\r\n// // //   useEffect(() => {\r\n// // //     fetchChart();\r\n// // //   }, [selectedProduct, selectedCategory, startDate, endDate]);\r\n\r\n// // //   return (\r\n// // //     <div className=\"analytics-container\">\r\n// // //       <h2 className=\"analytics-title\">üìÖ Price History & Analytics</h2>\r\n// // //       <p className=\"analytics-subtitle\">\r\n// // //         Track your product & category price trends over time\r\n// // //       </p>\r\n\r\n// // //       {/* Filters */}\r\n// // //       <div className=\"filter-section\">\r\n// // //         <div className=\"filter-group\">\r\n// // //           <label>üßÉ Product:</label>\r\n// // //           <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\r\n// // //             <option value=\"\">All Products</option>\r\n// // //             {productList.map((p) => (\r\n// // //               <option key={p._id} value={p.name}>{p.name}</option>\r\n// // //             ))}\r\n// // //           </select>\r\n// // //         </div>\r\n\r\n// // //         <div className=\"filter-group\">\r\n// // //           <label>üóÇÔ∏è Category:</label>\r\n// // //           <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\r\n// // //             <option value=\"\">All Categories</option>\r\n// // //             {categoryList.map((c) => (\r\n// // //               <option key={c._id} value={c.name}>{c.name}</option>\r\n// // //             ))}\r\n// // //           </select>\r\n// // //         </div>\r\n\r\n// // //         <div className=\"filter-group\">\r\n// // //           <label>üìÜ From:</label>\r\n// // //           <input type=\"date\" value={startDate} onChange={(e) => setStartDate(e.target.value)} />\r\n// // //         </div>\r\n\r\n// // //         <div className=\"filter-group\">\r\n// // //           <label>‚û° To:</label>\r\n// // //           <input type=\"date\" value={endDate} onChange={(e) => setEndDate(e.target.value)} />\r\n// // //         </div>\r\n\r\n// // //         <button className=\"btn refresh\" onClick={fetchChart}>üîÑ Apply</button>\r\n// // //       </div>\r\n\r\n// // //       {/* Chart */}\r\n// // //       <div className=\"chart-wrapper\">\r\n// // //         {loading ? (\r\n// // //           <div className=\"loading\">Loading chart...</div>\r\n// // //         ) : chartData ? (\r\n// // //           <Line\r\n// // //             data={chartData}\r\n// // //             options={{\r\n// // //               responsive: true,\r\n// // //               maintainAspectRatio: false,\r\n// // //               plugins: {\r\n// // //                 legend: { position: \"bottom\" },\r\n// // //               },\r\n// // //               scales: {\r\n// // //                 y: { beginAtZero: true },\r\n// // //               },\r\n// // //             }}\r\n// // //           />\r\n// // //         ) : (\r\n// // //           <div className=\"no-data\">No data found.</div>\r\n// // //         )}\r\n// // //       </div>\r\n// // //     </div>\r\n// // //   );\r\n// // // };\r\n\r\n// // // export default PriceAnalytics;\r\n// // import React, { useEffect, useState } from \"react\";\r\n// // import axios from \"axios\";\r\n// // import {\r\n// //   Chart as ChartJS,\r\n// //   CategoryScale,\r\n// //   LinearScale,\r\n// //   PointElement,\r\n// //   LineElement,\r\n// //   Title,\r\n// //   Tooltip,\r\n// //   Legend,\r\n// // } from \"chart.js\";\r\n// // import ChartDataLabels from \"chartjs-plugin-datalabels\";\r\n// // import { Line } from \"react-chartjs-2\";\r\n// // import \"./PriceAnalytics.css\";\r\n\r\n// // ChartJS.register(\r\n// //   CategoryScale,\r\n// //   LinearScale,\r\n// //   PointElement,\r\n// //   LineElement,\r\n// //   Title,\r\n// //   Tooltip,\r\n// //   Legend,\r\n// //   ChartDataLabels\r\n// // );\r\n\r\n// // const API_BASE = \"https://grocerrybackend.onrender.com/api\";\r\n\r\n// // const PriceAnalytics = () => {\r\n// //   const [loading, setLoading] = useState(true);\r\n// //   const [productList, setProductList] = useState([]);\r\n// //   const [categoryList, setCategoryList] = useState([]);\r\n// //   const [selectedProduct, setSelectedProduct] = useState(\"\");\r\n// //   const [selectedCategory, setSelectedCategory] = useState(\"\");\r\n// //   const [chartData, setChartData] = useState(null);\r\n\r\n// //   useEffect(() => {\r\n// //     const fetchDropdowns = async () => {\r\n// //       try {\r\n// //         const [p, c] = await Promise.all([\r\n// //           axios.get(`${API_BASE}/prices`),\r\n// //           axios.get(`${API_BASE}/categories`),\r\n// //         ]);\r\n\r\n// //         setProductList(p.data.data || []);\r\n// //         setCategoryList(c.data.categories || []);\r\n// //       } catch (err) {\r\n// //         console.error(\"Dropdown fetch error:\", err);\r\n// //       }\r\n// //     };\r\n\r\n// //     fetchDropdowns();\r\n// //   }, []);\r\n\r\n// //   const fetchChart = async () => {\r\n// //     setLoading(true);\r\n// //     try {\r\n// //       const res = await axios.get(`${API_BASE}/prices`);\r\n// //       let all = res.data.data || [];\r\n\r\n// //       // Filters\r\n// //       if (selectedProduct)\r\n// //         all = all.filter((p) => p.name === selectedProduct);\r\n\r\n// //       if (selectedCategory)\r\n// //         all = all.filter((p) => p.category?.name === selectedCategory);\r\n\r\n// //       // Group by Date\r\n// //       const grouped = {};\r\n// //       all.forEach((item) => {\r\n// //         const k = new Date(item.validTill || item.createdAt).toLocaleDateString(\"en-IN\");\r\n// //         if (!grouped[k]) grouped[k] = [];\r\n// //         grouped[k].push(item);\r\n// //       });\r\n\r\n// //       const labels = Object.keys(grouped);\r\n\r\n// //       // Final Price\r\n// //       const finalPrice = labels.map((d) => {\r\n// //         const arr = grouped[d];\r\n// //         return arr.reduce(\r\n// //           (sum, x) => sum + (Number(x.basePrice || 0) + Number(x.difference || 0)),\r\n// //           0\r\n// //         ) / arr.length;\r\n// //       });\r\n\r\n// //       setChartData({\r\n// //         labels,\r\n// //         datasets: [\r\n// //           {\r\n// //             label: \"Final Price (‚Çπ)\",\r\n// //             data: finalPrice,\r\n// //             borderColor: \"#007bff\",\r\n// //             backgroundColor: \"rgba(0,123,255,0.3)\",\r\n// //             tension: 0.3,\r\n// //           },\r\n// //         ],\r\n// //       });\r\n// //     } catch (err) {\r\n// //       console.error(\"Chart error:\", err);\r\n// //     } finally {\r\n// //       setLoading(false);\r\n// //     }\r\n// //   };\r\n\r\n// //   useEffect(() => {\r\n// //     fetchChart();\r\n// //   }, [selectedProduct, selectedCategory]);\r\n\r\n// //   return (\r\n// //     <div className=\"analytics-container\">\r\n// //       <h2 className=\"analytics-title\">üìä Final Price Analytics</h2>\r\n\r\n// //       {/* Filters */}\r\n// //       <div className=\"filter-section\">\r\n// //         <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\r\n// //           <option value=\"\">All Products</option>\r\n// //           {productList.map((p) => (\r\n// //             <option key={p._id} value={p.name}>{p.name}</option>\r\n// //           ))}\r\n// //         </select>\r\n\r\n// //         <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\r\n// //           <option value=\"\">All Categories</option>\r\n// //           {categoryList.map((c) => (\r\n// //             <option key={c._id} value={c.name}>{c.name}</option>\r\n// //           ))}\r\n// //         </select>\r\n\r\n// //         <button className=\"btn refresh\" onClick={fetchChart}>Apply</button>\r\n// //       </div>\r\n\r\n// //       {/* Chart */}\r\n// //       <div className=\"chart-wrapper\">\r\n// //         {loading ? (\r\n// //           <div className=\"loading\">Loading...</div>\r\n// //         ) : (\r\n// //           <Line\r\n// //             data={chartData}\r\n// //             options={{\r\n// //               responsive: true,\r\n// //               maintainAspectRatio: false,\r\n// //               plugins: {\r\n// //                 legend: { position: \"bottom\" },\r\n\r\n// //                 // ‚≠ê ALWAYS SHOW LABEL ‚≠ê\r\n// //                 datalabels: {\r\n// //                   color: \"#000\",\r\n// //                   anchor: \"end\",\r\n// //                   align: \"top\",\r\n// //                   formatter: (value) => `‚Çπ${value}`,\r\n// //                   font: {\r\n// //                     weight: \"bold\",\r\n// //                     size: 12,\r\n// //                   },\r\n// //                 },\r\n// //               },\r\n// //               scales: {\r\n// //                 y: { beginAtZero: true },\r\n// //               },\r\n// //             }}\r\n// //           />\r\n// //         )}\r\n// //       </div>\r\n// //     </div>\r\n// //   );\r\n// // };\r\n\r\n// // export default PriceAnalytics;\r\n\r\n// // import React, { useEffect, useState } from \"react\";\r\n// // import axios from \"axios\";\r\n// // import {\r\n// //   Chart as ChartJS,\r\n// //   CategoryScale,\r\n// //   LinearScale,\r\n// //   PointElement,\r\n// //   LineElement,\r\n// //   Title,\r\n// //   Tooltip,\r\n// //   Legend,\r\n// // } from \"chart.js\";\r\n// // import ChartDataLabels from \"chartjs-plugin-datalabels\";\r\n// // import { Line } from \"react-chartjs-2\";\r\n// // import \"./PriceAnalytics.css\";\r\n\r\n// // ChartJS.register(\r\n// //   CategoryScale,\r\n// //   LinearScale,\r\n// //   PointElement,\r\n// //   LineElement,\r\n// //   Title,\r\n// //   Tooltip,\r\n// //   Legend,\r\n// //   ChartDataLabels\r\n// // );\r\n\r\n// // const API_BASE = \"https://grocerrybackend.onrender.com/api\";\r\n\r\n// // const PriceAnalytics = () => {\r\n// //   const [loading, setLoading] = useState(true);\r\n// //   const [productList, setProductList] = useState([]);\r\n// //   const [categoryList, setCategoryList] = useState([]);\r\n// //   const [selectedProduct, setSelectedProduct] = useState(\"\");\r\n// //   const [selectedCategory, setSelectedCategory] = useState(\"\");\r\n\r\n// //   // NEW FILTER STATE\r\n// //   const [chartType, setChartType] = useState(\"daily\"); // daily, weekly, monthly, yearly, custom\r\n// //   const [startDate, setStartDate] = useState(\"\");\r\n// //   const [endDate, setEndDate] = useState(\"\");\r\n\r\n// //   const [chartData, setChartData] = useState(null);\r\n\r\n// //   useEffect(() => {\r\n// //     const fetchDropdowns = async () => {\r\n// //       try {\r\n// //         const [p, c] = await Promise.all([\r\n// //           axios.get(`${API_BASE}/prices`),\r\n// //           axios.get(`${API_BASE}/categories`),\r\n// //         ]);\r\n\r\n// //         setProductList(p.data.data || []);\r\n// //         setCategoryList(c.data.categories || []);\r\n// //       } catch (err) {\r\n// //         console.error(\"Dropdown fetch error:\", err);\r\n// //       }\r\n// //     };\r\n\r\n// //     fetchDropdowns();\r\n// //   }, []);\r\n\r\n// //   // üî• GROUPING HELPERS\r\n// //   const groupByWeek = (date) => {\r\n// //     const d = new Date(date);\r\n// //     const onejan = new Date(d.getFullYear(), 0, 1);\r\n// //     const week = Math.ceil(((d - onejan) / 86400000 + onejan.getDay() + 1) / 7);\r\n// //     return `Week ${week} - ${d.getFullYear()}`;\r\n// //   };\r\n\r\n// //   const groupByMonth = (date) => {\r\n// //     const d = new Date(date);\r\n// //     return `${d.toLocaleString(\"en-US\", { month: \"short\" })} ${d.getFullYear()}`;\r\n// //   };\r\n\r\n// //   const groupByYear = (date) => {\r\n// //     return new Date(date).getFullYear().toString();\r\n// //   };\r\n\r\n// //   const fetchChart = async () => {\r\n// //     setLoading(true);\r\n\r\n// //     try {\r\n// //       const res = await axios.get(`${API_BASE}/prices`);\r\n// //       let all = res.data.data || [];\r\n\r\n// //       // PRODUCT FILTER\r\n// //       if (selectedProduct)\r\n// //         all = all.filter((p) => p.name === selectedProduct);\r\n\r\n// //       // CATEGORY FILTER\r\n// //       if (selectedCategory)\r\n// //         all = all.filter((p) => p.category?.name === selectedCategory);\r\n\r\n// //       // RANGE FILTER\r\n// //       if (chartType === \"custom\" && startDate && endDate) {\r\n// //         const start = new Date(startDate);\r\n// //         const end = new Date(endDate);\r\n// //         all = all.filter((p) => {\r\n// //           const d = new Date(p.validTill || p.createdAt);\r\n// //           return d >= start && d <= end;\r\n// //         });\r\n// //       }\r\n\r\n// //       // GROUP DATA\r\n// //       const groups = {};\r\n\r\n// //       all.forEach((item) => {\r\n// //         const date = item.validTill || item.createdAt;\r\n\r\n// //         let groupKey = \"\";\r\n\r\n// //         switch (chartType) {\r\n// //           case \"weekly\":\r\n// //             groupKey = groupByWeek(date);\r\n// //             break;\r\n// //           case \"monthly\":\r\n// //             groupKey = groupByMonth(date);\r\n// //             break;\r\n// //           case \"yearly\":\r\n// //             groupKey = groupByYear(date);\r\n// //             break;\r\n// //           default:\r\n// //             groupKey = new Date(date).toLocaleDateString(\"en-IN\");\r\n// //         }\r\n\r\n// //         if (!groups[groupKey]) groups[groupKey] = [];\r\n// //         groups[groupKey].push(item);\r\n// //       });\r\n\r\n// //       const labels = Object.keys(groups);\r\n\r\n// //       const finalPriceAvg = labels.map((d) => {\r\n// //         const arr = groups[d];\r\n// //         return (\r\n// //           arr.reduce(\r\n// //             (sum, x) =>\r\n// //               sum + (Number(x.basePrice || 0) + Number(x.difference || 0)),\r\n// //             0\r\n// //           ) / arr.length\r\n// //         );\r\n// //       });\r\n\r\n// //       setChartData({\r\n// //         labels,\r\n// //         datasets: [\r\n// //           {\r\n// //             label: \"Final Price (‚Çπ)\",\r\n// //             data: finalPriceAvg,\r\n// //             borderColor: \"#007bff\",\r\n// //             backgroundColor: \"rgba(0,123,255,0.3)\",\r\n// //             tension: 0.3,\r\n// //           },\r\n// //         ],\r\n// //       });\r\n// //     } catch (err) {\r\n// //       console.error(\"Chart Error:\", err);\r\n// //     } finally {\r\n// //       setLoading(false);\r\n// //     }\r\n// //   };\r\n\r\n// //   useEffect(() => {\r\n// //     fetchChart();\r\n// //   }, [selectedProduct, selectedCategory, chartType, startDate, endDate]);\r\n\r\n// //   return (\r\n// //     <div className=\"analytics-container\">\r\n// //       <h2 className=\"analytics-title\">Price Analytics</h2>\r\n\r\n// //       <div className=\"filter-section\">\r\n        \r\n// //         {/* PRODUCT */}\r\n// //         <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\r\n// //           <option value=\"\">All Products</option>\r\n// //           {productList.map((p) => (\r\n// //             <option key={p._id} value={p.name}>{p.name}</option>\r\n// //           ))}\r\n// //         </select>\r\n\r\n// //         {/* CATEGORY */}\r\n// //         <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\r\n// //           <option value=\"\">All Categories</option>\r\n// //           {categoryList.map((c) => (\r\n// //             <option key={c._id} value={c.name}>{c.name}</option>\r\n// //           ))}\r\n// //         </select>\r\n\r\n// //         {/* TYPE FILTER */}\r\n// //         <select value={chartType} onChange={(e) => setChartType(e.target.value)}>\r\n// //           <option value=\"daily\">Daily</option>\r\n// //           <option value=\"weekly\">Weekly</option>\r\n// //           <option value=\"monthly\">Monthly</option>\r\n// //           <option value=\"yearly\">Yearly</option>\r\n// //           {/* <option value=\"custom\">Custom Range</option> */}\r\n// //         </select>\r\n\r\n// //         {/* DATE RANGE ONLY IF CUSTOM */}\r\n// //         {chartType === \"custom\" && (\r\n// //           <>\r\n// //             <input type=\"date\" value={startDate} onChange={(e) => setStartDate(e.target.value)} />\r\n// //             <input type=\"date\" value={endDate} onChange={(e) => setEndDate(e.target.value)} />\r\n// //           </>\r\n// //         )}\r\n\r\n// //         {/* <button className=\"btn refresh\" onClick={fetchChart}>Apply</button> */}\r\n// //       </div>\r\n\r\n// //       <div className=\"chart-wrapper\">\r\n// //         {loading ? (\r\n// //           <div className=\"loading\">Loading chart...</div>\r\n// //         ) : (\r\n// //           <Line\r\n// //             data={chartData}\r\n// //             options={{\r\n// //               responsive: true,\r\n// //               maintainAspectRatio: false,\r\n// //               plugins: {\r\n// //                 legend: { position: \"bottom\" },\r\n// //                 datalabels: {\r\n// //                   color: \"black\",\r\n// //                   anchor: \"end\",\r\n// //                   align: \"top\",\r\n// //                   formatter: (v) => `‚Çπ${v}`,\r\n// //                   font: { size: 12, weight: \"bold\" },\r\n// //                 },\r\n// //               },\r\n// //             }}\r\n// //           />\r\n// //         )}\r\n// //       </div>\r\n// //     </div>\r\n// //   );\r\n// // };\r\n\r\n// // export default PriceAnalytics;\r\n\r\n// import React, { useEffect, useState } from \"react\";\r\n// import axios from \"axios\";\r\n// import {\r\n//   Chart as ChartJS,\r\n//   CategoryScale,\r\n//   LinearScale,\r\n//   PointElement,\r\n//   LineElement,\r\n//   Tooltip,\r\n//   Legend,\r\n// } from \"chart.js\";\r\n// import ChartDataLabels from \"chartjs-plugin-datalabels\";\r\n// import { Line } from \"react-chartjs-2\";\r\n// import \"./PriceAnalytics.css\";\r\n\r\n// ChartJS.register(\r\n//   CategoryScale,\r\n//   LinearScale,\r\n//   PointElement,\r\n//   LineElement,\r\n//   Tooltip,\r\n//   Legend,\r\n//   ChartDataLabels\r\n// );\r\n\r\n// const API_BASE = \"https://grocerrybackend.onrender.com/api\";\r\n\r\n// export default function PriceAnalytics() {\r\n//   const [loading, setLoading] = useState(true);\r\n//   const [productList, setProductList] = useState([]);\r\n//   const [categoryList, setCategoryList] = useState([]);\r\n//   const [selectedProduct, setSelectedProduct] = useState(\"\");\r\n//   const [selectedCategory, setSelectedCategory] = useState(\"\");\r\n//   const [chartData, setChartData] = useState(null);\r\n\r\n//   /* ================= DROPDOWNS ================= */\r\n//   useEffect(() => {\r\n//     Promise.all([\r\n//       axios.get(`${API_BASE}/prices`),\r\n//       axios.get(`${API_BASE}/categories`),\r\n//     ]).then(([p, c]) => {\r\n//       setProductList(p.data.data || []);\r\n//       setCategoryList(c.data.categories || []);\r\n//     });\r\n//   }, []);\r\n\r\n//   /* ================= ZIG-ZAG CHART ================= */\r\n//   const fetchChart = async () => {\r\n//     setLoading(true);\r\n\r\n//     try {\r\n//       const res = await axios.get(`${API_BASE}/prices`);\r\n//       let data = res.data.data || [];\r\n\r\n//       // FILTERS\r\n//       if (selectedProduct)\r\n//         data = data.filter((p) => p.name === selectedProduct);\r\n\r\n//       if (selectedCategory)\r\n//         data = data.filter((p) => p.category?.name === selectedCategory);\r\n\r\n//       // SORT BY TIME (VERY IMPORTANT)\r\n//       data.sort(\r\n//         (a, b) =>\r\n//           new Date(a.createdAt || a.validTill) -\r\n//           new Date(b.createdAt || b.validTill)\r\n//       );\r\n\r\n//       const labels = data.map((item) =>\r\n//         new Date(item.createdAt || item.validTill).toLocaleString(\"en-IN\")\r\n//       );\r\n\r\n//       const prices = data.map((item) => {\r\n//         const base = Number(item.basePrice) || 0;\r\n//         const diff = Number(item.difference) || 0;\r\n//         return base + diff;\r\n//       });\r\n\r\n//       // SINGLE POINT FIX\r\n//       if (labels.length === 1) {\r\n//         labels.unshift(\"Earlier\");\r\n//         prices.unshift(prices[0]);\r\n//       }\r\n\r\n//       setChartData({\r\n//         labels,\r\n//         datasets: [\r\n//           {\r\n//             label: \"Final Price (‚Çπ)\",\r\n//             data: prices,\r\n//             borderColor: \"#dc3545\",\r\n//             backgroundColor: \"rgba(220,53,69,0.15)\",\r\n//             tension: 0,           // üî• NO SMOOTH ‚Üí SHARP ZIG ZAG\r\n//             fill: true,\r\n//             pointRadius: 5,\r\n//             pointHoverRadius: 7,\r\n//           },\r\n//         ],\r\n//       });\r\n//     } catch (err) {\r\n//       console.error(\"Chart error:\", err);\r\n//     } finally {\r\n//       setLoading(false);\r\n//     }\r\n//   };\r\n\r\n//   useEffect(() => {\r\n//     fetchChart();\r\n//   }, [selectedProduct, selectedCategory]);\r\n\r\n//   return (\r\n//     <div className=\"analytics-container\">\r\n//       <h2 className=\"analytics-title\">Price Analytics (Zig-Zag)</h2>\r\n\r\n//       <div className=\"filter-section\">\r\n//         <select onChange={(e) => setSelectedProduct(e.target.value)}>\r\n//           <option value=\"\">All Products</option>\r\n//           {productList.map((p) => (\r\n//             <option key={p._id} value={p.name}>{p.name}</option>\r\n//           ))}\r\n//         </select>\r\n\r\n//         <select onChange={(e) => setSelectedCategory(e.target.value)}>\r\n//           <option value=\"\">All Categories</option>\r\n//           {categoryList.map((c) => (\r\n//             <option key={c._id} value={c.name}>{c.name}</option>\r\n//           ))}\r\n//         </select>\r\n//       </div>\r\n\r\n//       <div className=\"chart-wrapper\">\r\n//         {loading ? (\r\n//           <div className=\"loading\">Loading...</div>\r\n//         ) : chartData ? (\r\n//           <Line\r\n//             data={chartData}\r\n//             options={{\r\n//               responsive: true,\r\n//               maintainAspectRatio: false,\r\n//               scales: {\r\n//                 y: { beginAtZero: false },\r\n//               },\r\n//               plugins: {\r\n//                 legend: { position: \"bottom\" },\r\n//                 datalabels: {\r\n//                   display: true,\r\n//                   align: \"top\",\r\n//                   formatter: (v) => `‚Çπ${v}`,\r\n//                   font: { weight: \"bold\" },\r\n//                 },\r\n//               },\r\n//             }}\r\n//           />\r\n//         ) : (\r\n//           <div className=\"no-data\">No data available</div>\r\n//         )}\r\n//       </div>\r\n//     </div>\r\n//   );\r\n// }\r\n\r\nimport React, { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport {\r\n  Chart as ChartJS,\r\n  CategoryScale,\r\n  LinearScale,\r\n  PointElement,\r\n  LineElement,\r\n  Tooltip,\r\n  Legend,\r\n} from \"chart.js\";\r\nimport ChartDataLabels from \"chartjs-plugin-datalabels\";\r\nimport { Line } from \"react-chartjs-2\";\r\nimport \"./PriceAnalytics.css\";\r\n\r\nChartJS.register(\r\n  CategoryScale,\r\n  LinearScale,\r\n  PointElement,\r\n  LineElement,\r\n  Tooltip,\r\n  Legend,\r\n  ChartDataLabels\r\n);\r\n\r\nconst API_BASE = \"https://grocerrybackend.onrender.com/api\";\r\n\r\nexport default function PriceAnalytics() {\r\n  const [loading, setLoading] = useState(true);\r\n  const [productList, setProductList] = useState([]);\r\n  const [categoryList, setCategoryList] = useState([]);\r\n  const [selectedProduct, setSelectedProduct] = useState(\"\");\r\n  const [selectedCategory, setSelectedCategory] = useState(\"\");\r\n  const [chartData, setChartData] = useState(null);\r\n\r\n  /* ================= LOAD DROPDOWNS ================= */\r\n  useEffect(() => {\r\n    Promise.all([\r\n      axios.get(`${API_BASE}/prices`),\r\n      axios.get(`${API_BASE}/categories`),\r\n    ]).then(([priceRes, catRes]) => {\r\n      // üî• Extract ONLY PRODUCTS from nested structure\r\n      const products = [];\r\n\r\n      // priceRes.data.data.forEach(category => {\r\n      //   category.subcategories.forEach(sub => {\r\n      //     sub.products.forEach(prod => {\r\n      //       products.push(prod);\r\n      //     });\r\n      //   });\r\n      // });\r\n     priceRes.data.data.forEach(category => {\r\n  category.subcategories.forEach(sub => {\r\n    sub.products.forEach(prod => {\r\n      products.push({\r\n        ...prod,\r\n        categoryName: category.name   // üî• attach category\r\n      });\r\n    });\r\n  });\r\n});\r\n      setProductList(products);\r\n      setCategoryList(catRes.data.categories || []);\r\n    });\r\n  }, []);\r\n\r\n  /* ================= FETCH CHART ================= */\r\n//   const fetchChart = async () => {\r\n//     setLoading(true);\r\n\r\n//     try {\r\n//       const res = await axios.get(`${API_BASE}/prices`);\r\n\r\n//       let data = [];\r\n\r\n//       // üî• Flatten Category ‚Üí Sub ‚Üí Products\r\n//       // res.data.data.forEach(category => {\r\n//       //   category.subcategories.forEach(sub => {\r\n//       //     sub.products.forEach(prod => {\r\n//       //       data.push(prod);\r\n//       //     });\r\n//       //   });\r\n//       // });\r\n\r\n//       priceRes.data.data.forEach(category => {\r\n//   category.subcategories.forEach(sub => {\r\n//     sub.products.forEach(prod => {\r\n//       products.push({\r\n//         ...prod,\r\n//         categoryName: category.name   // üî• attach category\r\n//       });\r\n//     });\r\n//   });\r\n// });\r\n\r\n//       // üî• Filters\r\n//       if (selectedProduct) {\r\n//         data = data.filter(p => p.name === selectedProduct);\r\n//       }\r\n\r\n//       // if (selectedCategory) {\r\n//       //   data = data.filter(p => p.category?.name === selectedCategory);\r\n//       // }\r\n\r\n      \r\n\r\n//       // üî• Sort by time\r\n//       data.sort(\r\n//         (a, b) =>\r\n//           new Date(a.createdAt || a.validTill) -\r\n//           new Date(b.createdAt || b.validTill)\r\n//       );\r\n\r\n//       const labels = data.map(item =>\r\n//         new Date(item.createdAt || item.validTill).toLocaleString(\"en-IN\")\r\n//       );\r\n\r\n//       const prices = data.map(item => {\r\n//         const base = Number(item.basePrice) || 0;\r\n//         const diff = Number(item.difference) || 0;\r\n//         return base + diff;\r\n//       });\r\n\r\n//       // Single point fix\r\n//       if (labels.length === 1) {\r\n//         labels.unshift(\"Earlier\");\r\n//         prices.unshift(prices[0]);\r\n//       }\r\n\r\n//       setChartData({\r\n//         labels,\r\n//         datasets: [\r\n//           {\r\n//             label: \"Final Price (‚Çπ)\",\r\n//             data: prices,\r\n//             borderColor: \"#dc3545\",\r\n//             backgroundColor: \"rgba(220,53,69,0.15)\",\r\n//             tension: 0,\r\n//             fill: true,\r\n//             pointRadius: 5,\r\n//             pointHoverRadius: 7,\r\n//           },\r\n//         ],\r\n//       });\r\n\r\n//     } catch (err) {\r\n//       console.error(\"Chart error:\", err);\r\n//     } finally {\r\n//       setLoading(false);\r\n//     }\r\n//   };\r\nconst fetchChart = async () => {\r\n  setLoading(true);\r\n\r\n  try {\r\n    const res = await axios.get(`${API_BASE}/prices`);\r\n\r\n    let data = [];\r\n\r\n    // ‚úÖ Proper flatten with category name\r\n    res.data.data.forEach(category => {\r\n      category.subcategories.forEach(sub => {\r\n        sub.products.forEach(prod => {\r\n          data.push({\r\n            ...prod,\r\n            categoryName: category.name   // üî• important\r\n          });\r\n        });\r\n      });\r\n    });\r\n\r\n    // ‚úÖ Product filter\r\n    if (selectedProduct) {\r\n      data = data.filter(p => p.name === selectedProduct);\r\n    }\r\n\r\n    // ‚úÖ Category filter\r\n    if (selectedCategory) {\r\n      data = data.filter(p => p.categoryName === selectedCategory);\r\n    }\r\n\r\n    // ‚ùó If nothing found, clear chart\r\n    if (data.length === 0) {\r\n      setChartData(null);\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    // ‚úÖ Sort by time\r\n    data.sort(\r\n      (a, b) =>\r\n        new Date(a.createdAt || a.validTill) -\r\n        new Date(b.createdAt || b.validTill)\r\n    );\r\n\r\n    const labels = data.map(item =>\r\n      new Date(item.createdAt || item.validTill).toLocaleString(\"en-IN\")\r\n    );\r\n\r\n    const prices = data.map(item => {\r\n      const base = Number(item.basePrice) || 0;\r\n      const diff = Number(item.difference) || 0;\r\n      return base + diff;\r\n    });\r\n\r\n    // Single point zigzag fix\r\n    if (labels.length === 1) {\r\n      labels.unshift(\"Earlier\");\r\n      prices.unshift(prices[0]);\r\n    }\r\n\r\n    setChartData({\r\n      labels,\r\n      datasets: [\r\n        {\r\n          label: \"Final Price (‚Çπ)\",\r\n          data: prices,\r\n          borderColor: \"#dc3545\",\r\n          backgroundColor: \"rgba(220,53,69,0.15)\",\r\n          tension: 0,\r\n          fill: true,\r\n          pointRadius: 5,\r\n          pointHoverRadius: 7,\r\n        },\r\n      ],\r\n    });\r\n\r\n  } catch (err) {\r\n    console.error(\"Chart error:\", err);\r\n  } finally {\r\n    setLoading(false);\r\n  }\r\n};\r\n\r\n\r\n  useEffect(() => {\r\n    fetchChart();\r\n  }, [selectedProduct, selectedCategory]);\r\n\r\n  /* ================= UI ================= */\r\n  return (\r\n    <div className=\"analytics-container\">\r\n      <h2 className=\"analytics-title\">Price Analytics (Zig-Zag)</h2>\r\n\r\n      <div className=\"filter-section\">\r\n        <select value={selectedProduct} onChange={e => setSelectedProduct(e.target.value)}>\r\n          <option value=\"\">All Products</option>\r\n          {productList.map(p => (\r\n            <option key={p._id} value={p.name}>{p.name}</option>\r\n          ))}\r\n        </select>\r\n\r\n        <select value={selectedCategory} onChange={e => setSelectedCategory(e.target.value)}>\r\n          <option value=\"\">All Categories</option>\r\n          {categoryList.map(c => (\r\n            <option key={c._id} value={c.name}>{c.name}</option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"chart-wrapper\">\r\n        {loading ? (\r\n          <div className=\"loading\">Loading...</div>\r\n        ) : chartData ? (\r\n          <Line\r\n            data={chartData}\r\n            options={{\r\n              responsive: true,\r\n              maintainAspectRatio: false,\r\n              scales: {\r\n                y: { beginAtZero: false },\r\n              },\r\n              plugins: {\r\n                legend: { position: \"bottom\" },\r\n                datalabels: {\r\n                  display: true,\r\n                  align: \"top\",\r\n                  formatter: v => `‚Çπ${v}`,\r\n                  font: { weight: \"bold\" },\r\n                },\r\n              },\r\n            }}\r\n          />\r\n        ) : (\r\n          <div className=\"no-data\">No data available</div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"4IAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OACEC,KAAK,GAAI,CAAAC,OAAO,CAChBC,aAAa,CACbC,WAAW,CACXC,YA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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}