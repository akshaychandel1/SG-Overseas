{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Rinku Sheoran\\\\Downloads\\\\g1\\\\Grocerryadminfrontend-main\\\\src\\\\pages\\\\admin\\\\PriceAnalytics.jsx\",\n  _s = $RefreshSig$();\n// // // import React, { useEffect, useState } from \"react\";\n// // // import axios from \"axios\";\n// // // import {\n// // //   Chart as ChartJS,\n// // //   CategoryScale,\n// // //   LinearScale,\n// // //   PointElement,\n// // //   LineElement,\n// // //   Title,\n// // //   Tooltip,\n// // //   Legend,\n// // // } from \"chart.js\";\n// // // import { Line } from \"react-chartjs-2\";\n// // // import \"./PriceAnalytics.css\";\n\n// // // ChartJS.register(\n// // //   CategoryScale,\n// // //   LinearScale,\n// // //   PointElement,\n// // //   LineElement,\n// // //   Title,\n// // //   Tooltip,\n// // //   Legend\n// // // );\n\n// // // const API_BASE = \"https://grocerrybackend.onrender.com/api\";\n\n// // // const PriceAnalytics = () => {\n// // //   const [loading, setLoading] = useState(true);\n// // //   const [productList, setProductList] = useState([]);\n// // //   const [categoryList, setCategoryList] = useState([]);\n// // //   const [selectedProduct, setSelectedProduct] = useState(\"\");\n// // //   const [selectedCategory, setSelectedCategory] = useState(\"\");\n// // //   const [startDate, setStartDate] = useState(\"\");\n// // //   const [endDate, setEndDate] = useState(\"\");\n// // //   const [chartData, setChartData] = useState(null);\n\n// // //   // üîπ Fetch dropdowns\n// // //   useEffect(() => {\n// // //     const fetchDropdowns = async () => {\n// // //       try {\n// // //         const [products, categories] = await Promise.all([\n// // //           axios.get(`${API_BASE}/prices`),\n// // //           axios.get(`${API_BASE}/categories`),\n// // //         ]);\n// // //         setProductList(products.data.data || []);\n// // //         setCategoryList(categories.data.categories || []);\n// // //       } catch (err) {\n// // //         console.error(\"Dropdown fetch error:\", err);\n// // //       }\n// // //     };\n// // //     fetchDropdowns();\n// // //   }, []);\n\n// // //   // üîπ Fetch chart data with date filter\n// // //   const fetchChart = async () => {\n// // //     setLoading(true);\n// // //     try {\n// // //       const res = await axios.get(`${API_BASE}/prices`);\n// // //       const allPrices = res.data.data || [];\n\n// // //       // ‚úÖ Filter by Product / Category\n// // //       let filtered = allPrices;\n// // //       if (selectedProduct)\n// // //         filtered = filtered.filter((p) => p.name === selectedProduct);\n// // //       if (selectedCategory)\n// // //         filtered = filtered.filter(\n// // //           (p) => p.category?.name === selectedCategory\n// // //         );\n\n// // //       // ‚úÖ Filter by Date Range\n// // //       if (startDate && endDate) {\n// // //         const start = new Date(startDate);\n// // //         const end = new Date(endDate);\n\n// // //         filtered = filtered.filter((item) => {\n// // //           const date = new Date(item.validTill || item.createdAt);\n// // //           return date >= start && date <= end;\n// // //         });\n// // //       }\n\n// // //       // ‚úÖ Group by Date\n// // //       const groupedByDate = {};\n// // //       filtered.forEach((item) => {\n// // //         const dateKey = new Date(\n// // //           item.validTill || item.createdAt\n// // //         ).toLocaleDateString(\"en-IN\");\n\n// // //         if (!groupedByDate[dateKey]) groupedByDate[dateKey] = [];\n// // //         groupedByDate[dateKey].push(item);\n// // //       });\n\n// // //       const labels = Object.keys(groupedByDate);\n\n// // //       const avgBasePrice = labels.map((d) => {\n// // //         const dayData = groupedByDate[d];\n// // //         return (\n// // //           dayData.reduce((sum, i) => sum + Number(i.basePrice || 0), 0) /\n// // //           dayData.length\n// // //         );\n// // //       });\n\n// // //       const avgDiff = labels.map((d) => {\n// // //         const dayData = groupedByDate[d];\n// // //         return (\n// // //           dayData.reduce((sum, i) => sum + Number(i.difference || 0), 0) /\n// // //           dayData.length\n// // //         );\n// // //       });\n\n// // //       const totalCount = labels.map((d) => groupedByDate[d].length);\n\n// // //       // üîπ Multiple Line Datasets\n// // //       setChartData({\n// // //         labels,\n// // //         datasets: [\n// // //           {\n// // //             label: \"Average Base Price (‚Çπ)\",\n// // //             data: avgBasePrice,\n// // //             borderColor: \"#007bff\",\n// // //             backgroundColor: \"rgba(0,123,255,0.3)\",\n// // //             tension: 0.3,\n// // //             fill: false,\n// // //           },\n// // //           {\n// // //             label: \"Average Difference (‚Çπ)\",\n// // //             data: avgDiff,\n// // //             borderColor: \"#ffc107\",\n// // //             backgroundColor: \"rgba(255,193,7,0.3)\",\n// // //             tension: 0.3,\n// // //             fill: false,\n// // //           },\n// // //           {\n// // //             label: \"Total Products Count\",\n// // //             data: totalCount,\n// // //             borderColor: \"#28a745\",\n// // //             backgroundColor: \"rgba(40,167,69,0.3)\",\n// // //             tension: 0.3,\n// // //             fill: false,\n// // //           },\n// // //         ],\n// // //       });\n// // //     } catch (err) {\n// // //       console.error(\"Chart fetch error:\", err);\n// // //     } finally {\n// // //       setLoading(false);\n// // //     }\n// // //   };\n\n// // //   useEffect(() => {\n// // //     fetchChart();\n// // //   }, [selectedProduct, selectedCategory, startDate, endDate]);\n\n// // //   return (\n// // //     <div className=\"analytics-container\">\n// // //       <h2 className=\"analytics-title\">üìÖ Price History & Analytics</h2>\n// // //       <p className=\"analytics-subtitle\">\n// // //         Track your product & category price trends over time\n// // //       </p>\n\n// // //       {/* Filters */}\n// // //       <div className=\"filter-section\">\n// // //         <div className=\"filter-group\">\n// // //           <label>üßÉ Product:</label>\n// // //           <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\n// // //             <option value=\"\">All Products</option>\n// // //             {productList.map((p) => (\n// // //               <option key={p._id} value={p.name}>{p.name}</option>\n// // //             ))}\n// // //           </select>\n// // //         </div>\n\n// // //         <div className=\"filter-group\">\n// // //           <label>üóÇÔ∏è Category:</label>\n// // //           <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\n// // //             <option value=\"\">All Categories</option>\n// // //             {categoryList.map((c) => (\n// // //               <option key={c._id} value={c.name}>{c.name}</option>\n// // //             ))}\n// // //           </select>\n// // //         </div>\n\n// // //         <div className=\"filter-group\">\n// // //           <label>üìÜ From:</label>\n// // //           <input type=\"date\" value={startDate} onChange={(e) => setStartDate(e.target.value)} />\n// // //         </div>\n\n// // //         <div className=\"filter-group\">\n// // //           <label>‚û° To:</label>\n// // //           <input type=\"date\" value={endDate} onChange={(e) => setEndDate(e.target.value)} />\n// // //         </div>\n\n// // //         <button className=\"btn refresh\" onClick={fetchChart}>üîÑ Apply</button>\n// // //       </div>\n\n// // //       {/* Chart */}\n// // //       <div className=\"chart-wrapper\">\n// // //         {loading ? (\n// // //           <div className=\"loading\">Loading chart...</div>\n// // //         ) : chartData ? (\n// // //           <Line\n// // //             data={chartData}\n// // //             options={{\n// // //               responsive: true,\n// // //               maintainAspectRatio: false,\n// // //               plugins: {\n// // //                 legend: { position: \"bottom\" },\n// // //               },\n// // //               scales: {\n// // //                 y: { beginAtZero: true },\n// // //               },\n// // //             }}\n// // //           />\n// // //         ) : (\n// // //           <div className=\"no-data\">No data found.</div>\n// // //         )}\n// // //       </div>\n// // //     </div>\n// // //   );\n// // // };\n\n// // // export default PriceAnalytics;\n// // import React, { useEffect, useState } from \"react\";\n// // import axios from \"axios\";\n// // import {\n// //   Chart as ChartJS,\n// //   CategoryScale,\n// //   LinearScale,\n// //   PointElement,\n// //   LineElement,\n// //   Title,\n// //   Tooltip,\n// //   Legend,\n// // } from \"chart.js\";\n// // import ChartDataLabels from \"chartjs-plugin-datalabels\";\n// // import { Line } from \"react-chartjs-2\";\n// // import \"./PriceAnalytics.css\";\n\n// // ChartJS.register(\n// //   CategoryScale,\n// //   LinearScale,\n// //   PointElement,\n// //   LineElement,\n// //   Title,\n// //   Tooltip,\n// //   Legend,\n// //   ChartDataLabels\n// // );\n\n// // const API_BASE = \"https://grocerrybackend.onrender.com/api\";\n\n// // const PriceAnalytics = () => {\n// //   const [loading, setLoading] = useState(true);\n// //   const [productList, setProductList] = useState([]);\n// //   const [categoryList, setCategoryList] = useState([]);\n// //   const [selectedProduct, setSelectedProduct] = useState(\"\");\n// //   const [selectedCategory, setSelectedCategory] = useState(\"\");\n// //   const [chartData, setChartData] = useState(null);\n\n// //   useEffect(() => {\n// //     const fetchDropdowns = async () => {\n// //       try {\n// //         const [p, c] = await Promise.all([\n// //           axios.get(`${API_BASE}/prices`),\n// //           axios.get(`${API_BASE}/categories`),\n// //         ]);\n\n// //         setProductList(p.data.data || []);\n// //         setCategoryList(c.data.categories || []);\n// //       } catch (err) {\n// //         console.error(\"Dropdown fetch error:\", err);\n// //       }\n// //     };\n\n// //     fetchDropdowns();\n// //   }, []);\n\n// //   const fetchChart = async () => {\n// //     setLoading(true);\n// //     try {\n// //       const res = await axios.get(`${API_BASE}/prices`);\n// //       let all = res.data.data || [];\n\n// //       // Filters\n// //       if (selectedProduct)\n// //         all = all.filter((p) => p.name === selectedProduct);\n\n// //       if (selectedCategory)\n// //         all = all.filter((p) => p.category?.name === selectedCategory);\n\n// //       // Group by Date\n// //       const grouped = {};\n// //       all.forEach((item) => {\n// //         const k = new Date(item.validTill || item.createdAt).toLocaleDateString(\"en-IN\");\n// //         if (!grouped[k]) grouped[k] = [];\n// //         grouped[k].push(item);\n// //       });\n\n// //       const labels = Object.keys(grouped);\n\n// //       // Final Price\n// //       const finalPrice = labels.map((d) => {\n// //         const arr = grouped[d];\n// //         return arr.reduce(\n// //           (sum, x) => sum + (Number(x.basePrice || 0) + Number(x.difference || 0)),\n// //           0\n// //         ) / arr.length;\n// //       });\n\n// //       setChartData({\n// //         labels,\n// //         datasets: [\n// //           {\n// //             label: \"Final Price (‚Çπ)\",\n// //             data: finalPrice,\n// //             borderColor: \"#007bff\",\n// //             backgroundColor: \"rgba(0,123,255,0.3)\",\n// //             tension: 0.3,\n// //           },\n// //         ],\n// //       });\n// //     } catch (err) {\n// //       console.error(\"Chart error:\", err);\n// //     } finally {\n// //       setLoading(false);\n// //     }\n// //   };\n\n// //   useEffect(() => {\n// //     fetchChart();\n// //   }, [selectedProduct, selectedCategory]);\n\n// //   return (\n// //     <div className=\"analytics-container\">\n// //       <h2 className=\"analytics-title\">üìä Final Price Analytics</h2>\n\n// //       {/* Filters */}\n// //       <div className=\"filter-section\">\n// //         <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\n// //           <option value=\"\">All Products</option>\n// //           {productList.map((p) => (\n// //             <option key={p._id} value={p.name}>{p.name}</option>\n// //           ))}\n// //         </select>\n\n// //         <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\n// //           <option value=\"\">All Categories</option>\n// //           {categoryList.map((c) => (\n// //             <option key={c._id} value={c.name}>{c.name}</option>\n// //           ))}\n// //         </select>\n\n// //         <button className=\"btn refresh\" onClick={fetchChart}>Apply</button>\n// //       </div>\n\n// //       {/* Chart */}\n// //       <div className=\"chart-wrapper\">\n// //         {loading ? (\n// //           <div className=\"loading\">Loading...</div>\n// //         ) : (\n// //           <Line\n// //             data={chartData}\n// //             options={{\n// //               responsive: true,\n// //               maintainAspectRatio: false,\n// //               plugins: {\n// //                 legend: { position: \"bottom\" },\n\n// //                 // ‚≠ê ALWAYS SHOW LABEL ‚≠ê\n// //                 datalabels: {\n// //                   color: \"#000\",\n// //                   anchor: \"end\",\n// //                   align: \"top\",\n// //                   formatter: (value) => `‚Çπ${value}`,\n// //                   font: {\n// //                     weight: \"bold\",\n// //                     size: 12,\n// //                   },\n// //                 },\n// //               },\n// //               scales: {\n// //                 y: { beginAtZero: true },\n// //               },\n// //             }}\n// //           />\n// //         )}\n// //       </div>\n// //     </div>\n// //   );\n// // };\n\n// // export default PriceAnalytics;\n\n// import React, { useEffect, useState } from \"react\";\n// import axios from \"axios\";\n// import {\n//   Chart as ChartJS,\n//   CategoryScale,\n//   LinearScale,\n//   PointElement,\n//   LineElement,\n//   Title,\n//   Tooltip,\n//   Legend,\n// } from \"chart.js\";\n// import ChartDataLabels from \"chartjs-plugin-datalabels\";\n// import { Line } from \"react-chartjs-2\";\n// import \"./PriceAnalytics.css\";\n\n// ChartJS.register(\n//   CategoryScale,\n//   LinearScale,\n//   PointElement,\n//   LineElement,\n//   Title,\n//   Tooltip,\n//   Legend,\n//   ChartDataLabels\n// );\n\n// const API_BASE = \"https://grocerrybackend.onrender.com/api\";\n\n// const PriceAnalytics = () => {\n//   const [loading, setLoading] = useState(true);\n//   const [productList, setProductList] = useState([]);\n//   const [categoryList, setCategoryList] = useState([]);\n//   const [selectedProduct, setSelectedProduct] = useState(\"\");\n//   const [selectedCategory, setSelectedCategory] = useState(\"\");\n\n//   // NEW FILTER STATE\n//   const [chartType, setChartType] = useState(\"daily\"); // daily, weekly, monthly, yearly, custom\n//   const [startDate, setStartDate] = useState(\"\");\n//   const [endDate, setEndDate] = useState(\"\");\n\n//   const [chartData, setChartData] = useState(null);\n\n//   useEffect(() => {\n//     const fetchDropdowns = async () => {\n//       try {\n//         const [p, c] = await Promise.all([\n//           axios.get(`${API_BASE}/prices`),\n//           axios.get(`${API_BASE}/categories`),\n//         ]);\n\n//         setProductList(p.data.data || []);\n//         setCategoryList(c.data.categories || []);\n//       } catch (err) {\n//         console.error(\"Dropdown fetch error:\", err);\n//       }\n//     };\n\n//     fetchDropdowns();\n//   }, []);\n\n//   // üî• GROUPING HELPERS\n//   const groupByWeek = (date) => {\n//     const d = new Date(date);\n//     const onejan = new Date(d.getFullYear(), 0, 1);\n//     const week = Math.ceil(((d - onejan) / 86400000 + onejan.getDay() + 1) / 7);\n//     return `Week ${week} - ${d.getFullYear()}`;\n//   };\n\n//   const groupByMonth = (date) => {\n//     const d = new Date(date);\n//     return `${d.toLocaleString(\"en-US\", { month: \"short\" })} ${d.getFullYear()}`;\n//   };\n\n//   const groupByYear = (date) => {\n//     return new Date(date).getFullYear().toString();\n//   };\n\n//   const fetchChart = async () => {\n//     setLoading(true);\n\n//     try {\n//       const res = await axios.get(`${API_BASE}/prices`);\n//       let all = res.data.data || [];\n\n//       // PRODUCT FILTER\n//       if (selectedProduct)\n//         all = all.filter((p) => p.name === selectedProduct);\n\n//       // CATEGORY FILTER\n//       if (selectedCategory)\n//         all = all.filter((p) => p.category?.name === selectedCategory);\n\n//       // RANGE FILTER\n//       if (chartType === \"custom\" && startDate && endDate) {\n//         const start = new Date(startDate);\n//         const end = new Date(endDate);\n//         all = all.filter((p) => {\n//           const d = new Date(p.validTill || p.createdAt);\n//           return d >= start && d <= end;\n//         });\n//       }\n\n//       // GROUP DATA\n//       const groups = {};\n\n//       all.forEach((item) => {\n//         const date = item.validTill || item.createdAt;\n\n//         let groupKey = \"\";\n\n//         switch (chartType) {\n//           case \"weekly\":\n//             groupKey = groupByWeek(date);\n//             break;\n//           case \"monthly\":\n//             groupKey = groupByMonth(date);\n//             break;\n//           case \"yearly\":\n//             groupKey = groupByYear(date);\n//             break;\n//           default:\n//             groupKey = new Date(date).toLocaleDateString(\"en-IN\");\n//         }\n\n//         if (!groups[groupKey]) groups[groupKey] = [];\n//         groups[groupKey].push(item);\n//       });\n\n//       const labels = Object.keys(groups);\n\n//       const finalPriceAvg = labels.map((d) => {\n//         const arr = groups[d];\n//         return (\n//           arr.reduce(\n//             (sum, x) =>\n//               sum + (Number(x.basePrice || 0) + Number(x.difference || 0)),\n//             0\n//           ) / arr.length\n//         );\n//       });\n\n//       setChartData({\n//         labels,\n//         datasets: [\n//           {\n//             label: \"Final Price (‚Çπ)\",\n//             data: finalPriceAvg,\n//             borderColor: \"#007bff\",\n//             backgroundColor: \"rgba(0,123,255,0.3)\",\n//             tension: 0.3,\n//           },\n//         ],\n//       });\n//     } catch (err) {\n//       console.error(\"Chart Error:\", err);\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\n\n//   useEffect(() => {\n//     fetchChart();\n//   }, [selectedProduct, selectedCategory, chartType, startDate, endDate]);\n\n//   return (\n//     <div className=\"analytics-container\">\n//       <h2 className=\"analytics-title\">Price Analytics</h2>\n\n//       <div className=\"filter-section\">\n\n//         {/* PRODUCT */}\n//         <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\n//           <option value=\"\">All Products</option>\n//           {productList.map((p) => (\n//             <option key={p._id} value={p.name}>{p.name}</option>\n//           ))}\n//         </select>\n\n//         {/* CATEGORY */}\n//         <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\n//           <option value=\"\">All Categories</option>\n//           {categoryList.map((c) => (\n//             <option key={c._id} value={c.name}>{c.name}</option>\n//           ))}\n//         </select>\n\n//         {/* TYPE FILTER */}\n//         <select value={chartType} onChange={(e) => setChartType(e.target.value)}>\n//           <option value=\"daily\">Daily</option>\n//           <option value=\"weekly\">Weekly</option>\n//           <option value=\"monthly\">Monthly</option>\n//           <option value=\"yearly\">Yearly</option>\n//           {/* <option value=\"custom\">Custom Range</option> */}\n//         </select>\n\n//         {/* DATE RANGE ONLY IF CUSTOM */}\n//         {chartType === \"custom\" && (\n//           <>\n//             <input type=\"date\" value={startDate} onChange={(e) => setStartDate(e.target.value)} />\n//             <input type=\"date\" value={endDate} onChange={(e) => setEndDate(e.target.value)} />\n//           </>\n//         )}\n\n//         {/* <button className=\"btn refresh\" onClick={fetchChart}>Apply</button> */}\n//       </div>\n\n//       <div className=\"chart-wrapper\">\n//         {loading ? (\n//           <div className=\"loading\">Loading chart...</div>\n//         ) : (\n//           <Line\n//             data={chartData}\n//             options={{\n//               responsive: true,\n//               maintainAspectRatio: false,\n//               plugins: {\n//                 legend: { position: \"bottom\" },\n//                 datalabels: {\n//                   color: \"black\",\n//                   anchor: \"end\",\n//                   align: \"top\",\n//                   formatter: (v) => `‚Çπ${v}`,\n//                   font: { size: 12, weight: \"bold\" },\n//                 },\n//               },\n//             }}\n//           />\n//         )}\n//       </div>\n//     </div>\n//   );\n// };\n\n// export default PriceAnalytics;\n\nimport React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport { Chart as ChartJS, CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend } from \"chart.js\";\nimport ChartDataLabels from \"chartjs-plugin-datalabels\";\nimport { Line } from \"react-chartjs-2\";\nimport \"./PriceAnalytics.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nChartJS.register(CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend, ChartDataLabels);\nconst API_BASE = \"https://grocerrybackend.onrender.com/api\";\nexport default function PriceAnalytics() {\n  _s();\n  const [loading, setLoading] = useState(true);\n  const [productList, setProductList] = useState([]);\n  const [categoryList, setCategoryList] = useState([]);\n  const [selectedProduct, setSelectedProduct] = useState(\"\");\n  const [selectedCategory, setSelectedCategory] = useState(\"\");\n  const [chartType, setChartType] = useState(\"daily\");\n  const [chartData, setChartData] = useState(null);\n\n  /* ================= FETCH DROPDOWNS ================= */\n  useEffect(() => {\n    const fetchDropdowns = async () => {\n      try {\n        const [p, c] = await Promise.all([axios.get(`${API_BASE}/prices`), axios.get(`${API_BASE}/categories`)]);\n        setProductList(p.data.data || []);\n        setCategoryList(c.data.categories || []);\n      } catch (e) {\n        console.error(e);\n      }\n    };\n    fetchDropdowns();\n  }, []);\n\n  /* ================= GROUP HELPERS ================= */\n  const groupByWeek = date => {\n    const d = new Date(date);\n    const onejan = new Date(d.getFullYear(), 0, 1);\n    const week = Math.ceil(((d - onejan) / 86400000 + onejan.getDay() + 1) / 7);\n    return `Week ${week}`;\n  };\n  const groupByMonth = date => new Date(date).toLocaleString(\"en-IN\", {\n    month: \"short\",\n    year: \"numeric\"\n  });\n  const groupByYear = date => new Date(date).getFullYear().toString();\n\n  /* ================= FETCH & BUILD CHART ================= */\n  const fetchChart = async () => {\n    setLoading(true);\n    try {\n      const res = await axios.get(`${API_BASE}/prices`);\n      let data = res.data.data || [];\n      if (selectedProduct) data = data.filter(p => p.name === selectedProduct);\n      if (selectedCategory) data = data.filter(p => {\n        var _p$category;\n        return ((_p$category = p.category) === null || _p$category === void 0 ? void 0 : _p$category.name) === selectedCategory;\n      });\n      const groups = {};\n      data.forEach(item => {\n        const date = item.validTill || item.createdAt;\n        let key = \"\";\n        if (chartType === \"weekly\") key = groupByWeek(date);else if (chartType === \"monthly\") key = groupByMonth(date);else if (chartType === \"yearly\") key = groupByYear(date);else key = new Date(date).toLocaleDateString(\"en-IN\");\n        if (!groups[key]) groups[key] = [];\n        groups[key].push(item);\n      });\n      const labels = Object.keys(groups).sort();\n      if (labels.length === 0) {\n        setChartData(null);\n        return;\n      }\n      const prices = labels.map(label => {\n        const arr = groups[label];\n        const total = arr.reduce((sum, x) => {\n          const base = Number(x.basePrice) || 0;\n          const diff = Number(x.difference) || 0;\n          return sum + base + diff;\n        }, 0);\n        return Number((total / arr.length).toFixed(2));\n      });\n      setChartData({\n        labels,\n        datasets: [{\n          label: \"Final Price (‚Çπ)\",\n          data: prices,\n          borderColor: \"#dc3545\",\n          backgroundColor: \"rgba(220,53,69,0.25)\",\n          tension: 0.4,\n          fill: true,\n          pointRadius: 4,\n          pointBackgroundColor: \"#dc3545\"\n        }]\n      });\n    } catch (e) {\n      console.error(\"Chart error:\", e);\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    fetchChart();\n  }, [selectedProduct, selectedCategory, chartType]);\n\n  /* ================= UI ================= */\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"analytics-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"analytics-title\",\n      children: \"Price Analytics\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 775,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"filter-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"select\", {\n        value: selectedProduct,\n        onChange: e => setSelectedProduct(e.target.value),\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"All Products\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 779,\n          columnNumber: 11\n        }, this), productList.map(p => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: p.name,\n          children: p.name\n        }, p._id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 781,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 778,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        value: selectedCategory,\n        onChange: e => setSelectedCategory(e.target.value),\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"All Categories\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 786,\n          columnNumber: 11\n        }, this), categoryList.map(c => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: c.name,\n          children: c.name\n        }, c._id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 788,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 785,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        value: chartType,\n        onChange: e => setChartType(e.target.value),\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"daily\",\n          children: \"Daily\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 793,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"weekly\",\n          children: \"Weekly\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 794,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"monthly\",\n          children: \"Monthly\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 795,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"yearly\",\n          children: \"Yearly\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 796,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 792,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 777,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chart-wrapper\",\n      children: loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading\",\n        children: \"Loading chart...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 802,\n        columnNumber: 11\n      }, this) : chartData ? /*#__PURE__*/_jsxDEV(Line, {\n        data: chartData,\n        options: {\n          responsive: true,\n          maintainAspectRatio: false,\n          plugins: {\n            legend: {\n              position: \"bottom\"\n            },\n            datalabels: {\n              display: true,\n              color: \"#000\",\n              align: \"top\",\n              formatter: v => `‚Çπ${v}`\n            }\n          },\n          scales: {\n            y: {\n              beginAtZero: true\n            }\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 804,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"no-data\",\n        children: \"No data available\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 824,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 800,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 774,\n    columnNumber: 5\n  }, this);\n}\n_s(PriceAnalytics, \"FhPpwneEjv7MrY2Ofuz1Ed3+eM4=\");\n_c = PriceAnalytics;\nvar _c;\n$RefreshReg$(_c, \"PriceAnalytics\");","map":{"version":3,"names":["React","useEffect","useState","axios","Chart","ChartJS","CategoryScale","LinearScale","PointElement","LineElement","Title","Tooltip","Legend","ChartDataLabels","Line","jsxDEV","_jsxDEV","register","API_BASE","PriceAnalytics","_s","loading","setLoading","productList","setProductList","categoryList","setCategoryList","selectedProduct","setSelectedProduct","selectedCategory","setSelectedCategory","chartType","setChartType","chartData","setChartData","fetchDropdowns","p","c","Promise","all","get","data","categories","e","console","error","groupByWeek","date","d","Date","onejan","getFullYear","week","Math","ceil","getDay","groupByMonth","toLocaleString","month","year","groupByYear","toString","fetchChart","res","filter","name","_p$category","category","groups","forEach","item","validTill","createdAt","key","toLocaleDateString","push","labels","Object","keys","sort","length","prices","map","label","arr","total","reduce","sum","x","base","Number","basePrice","diff","difference","toFixed","datasets","borderColor","backgroundColor","tension","fill","pointRadius","pointBackgroundColor","className","children","fileName","_jsxFileName","lineNumber","columnNumber","value","onChange","target","_id","options","responsive","maintainAspectRatio","plugins","legend","position","datalabels","display","color","align","formatter","v","scales","y","beginAtZero","_c","$RefreshReg$"],"sources":["C:/Users/Rinku Sheoran/Downloads/g1/Grocerryadminfrontend-main/src/pages/admin/PriceAnalytics.jsx"],"sourcesContent":["\r\n\r\n// // // import React, { useEffect, useState } from \"react\";\r\n// // // import axios from \"axios\";\r\n// // // import {\r\n// // //   Chart as ChartJS,\r\n// // //   CategoryScale,\r\n// // //   LinearScale,\r\n// // //   PointElement,\r\n// // //   LineElement,\r\n// // //   Title,\r\n// // //   Tooltip,\r\n// // //   Legend,\r\n// // // } from \"chart.js\";\r\n// // // import { Line } from \"react-chartjs-2\";\r\n// // // import \"./PriceAnalytics.css\";\r\n\r\n// // // ChartJS.register(\r\n// // //   CategoryScale,\r\n// // //   LinearScale,\r\n// // //   PointElement,\r\n// // //   LineElement,\r\n// // //   Title,\r\n// // //   Tooltip,\r\n// // //   Legend\r\n// // // );\r\n\r\n// // // const API_BASE = \"https://grocerrybackend.onrender.com/api\";\r\n\r\n// // // const PriceAnalytics = () => {\r\n// // //   const [loading, setLoading] = useState(true);\r\n// // //   const [productList, setProductList] = useState([]);\r\n// // //   const [categoryList, setCategoryList] = useState([]);\r\n// // //   const [selectedProduct, setSelectedProduct] = useState(\"\");\r\n// // //   const [selectedCategory, setSelectedCategory] = useState(\"\");\r\n// // //   const [startDate, setStartDate] = useState(\"\");\r\n// // //   const [endDate, setEndDate] = useState(\"\");\r\n// // //   const [chartData, setChartData] = useState(null);\r\n\r\n// // //   // üîπ Fetch dropdowns\r\n// // //   useEffect(() => {\r\n// // //     const fetchDropdowns = async () => {\r\n// // //       try {\r\n// // //         const [products, categories] = await Promise.all([\r\n// // //           axios.get(`${API_BASE}/prices`),\r\n// // //           axios.get(`${API_BASE}/categories`),\r\n// // //         ]);\r\n// // //         setProductList(products.data.data || []);\r\n// // //         setCategoryList(categories.data.categories || []);\r\n// // //       } catch (err) {\r\n// // //         console.error(\"Dropdown fetch error:\", err);\r\n// // //       }\r\n// // //     };\r\n// // //     fetchDropdowns();\r\n// // //   }, []);\r\n\r\n// // //   // üîπ Fetch chart data with date filter\r\n// // //   const fetchChart = async () => {\r\n// // //     setLoading(true);\r\n// // //     try {\r\n// // //       const res = await axios.get(`${API_BASE}/prices`);\r\n// // //       const allPrices = res.data.data || [];\r\n\r\n// // //       // ‚úÖ Filter by Product / Category\r\n// // //       let filtered = allPrices;\r\n// // //       if (selectedProduct)\r\n// // //         filtered = filtered.filter((p) => p.name === selectedProduct);\r\n// // //       if (selectedCategory)\r\n// // //         filtered = filtered.filter(\r\n// // //           (p) => p.category?.name === selectedCategory\r\n// // //         );\r\n\r\n// // //       // ‚úÖ Filter by Date Range\r\n// // //       if (startDate && endDate) {\r\n// // //         const start = new Date(startDate);\r\n// // //         const end = new Date(endDate);\r\n\r\n// // //         filtered = filtered.filter((item) => {\r\n// // //           const date = new Date(item.validTill || item.createdAt);\r\n// // //           return date >= start && date <= end;\r\n// // //         });\r\n// // //       }\r\n\r\n// // //       // ‚úÖ Group by Date\r\n// // //       const groupedByDate = {};\r\n// // //       filtered.forEach((item) => {\r\n// // //         const dateKey = new Date(\r\n// // //           item.validTill || item.createdAt\r\n// // //         ).toLocaleDateString(\"en-IN\");\r\n\r\n// // //         if (!groupedByDate[dateKey]) groupedByDate[dateKey] = [];\r\n// // //         groupedByDate[dateKey].push(item);\r\n// // //       });\r\n\r\n// // //       const labels = Object.keys(groupedByDate);\r\n\r\n// // //       const avgBasePrice = labels.map((d) => {\r\n// // //         const dayData = groupedByDate[d];\r\n// // //         return (\r\n// // //           dayData.reduce((sum, i) => sum + Number(i.basePrice || 0), 0) /\r\n// // //           dayData.length\r\n// // //         );\r\n// // //       });\r\n\r\n// // //       const avgDiff = labels.map((d) => {\r\n// // //         const dayData = groupedByDate[d];\r\n// // //         return (\r\n// // //           dayData.reduce((sum, i) => sum + Number(i.difference || 0), 0) /\r\n// // //           dayData.length\r\n// // //         );\r\n// // //       });\r\n\r\n// // //       const totalCount = labels.map((d) => groupedByDate[d].length);\r\n\r\n// // //       // üîπ Multiple Line Datasets\r\n// // //       setChartData({\r\n// // //         labels,\r\n// // //         datasets: [\r\n// // //           {\r\n// // //             label: \"Average Base Price (‚Çπ)\",\r\n// // //             data: avgBasePrice,\r\n// // //             borderColor: \"#007bff\",\r\n// // //             backgroundColor: \"rgba(0,123,255,0.3)\",\r\n// // //             tension: 0.3,\r\n// // //             fill: false,\r\n// // //           },\r\n// // //           {\r\n// // //             label: \"Average Difference (‚Çπ)\",\r\n// // //             data: avgDiff,\r\n// // //             borderColor: \"#ffc107\",\r\n// // //             backgroundColor: \"rgba(255,193,7,0.3)\",\r\n// // //             tension: 0.3,\r\n// // //             fill: false,\r\n// // //           },\r\n// // //           {\r\n// // //             label: \"Total Products Count\",\r\n// // //             data: totalCount,\r\n// // //             borderColor: \"#28a745\",\r\n// // //             backgroundColor: \"rgba(40,167,69,0.3)\",\r\n// // //             tension: 0.3,\r\n// // //             fill: false,\r\n// // //           },\r\n// // //         ],\r\n// // //       });\r\n// // //     } catch (err) {\r\n// // //       console.error(\"Chart fetch error:\", err);\r\n// // //     } finally {\r\n// // //       setLoading(false);\r\n// // //     }\r\n// // //   };\r\n\r\n// // //   useEffect(() => {\r\n// // //     fetchChart();\r\n// // //   }, [selectedProduct, selectedCategory, startDate, endDate]);\r\n\r\n// // //   return (\r\n// // //     <div className=\"analytics-container\">\r\n// // //       <h2 className=\"analytics-title\">üìÖ Price History & Analytics</h2>\r\n// // //       <p className=\"analytics-subtitle\">\r\n// // //         Track your product & category price trends over time\r\n// // //       </p>\r\n\r\n// // //       {/* Filters */}\r\n// // //       <div className=\"filter-section\">\r\n// // //         <div className=\"filter-group\">\r\n// // //           <label>üßÉ Product:</label>\r\n// // //           <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\r\n// // //             <option value=\"\">All Products</option>\r\n// // //             {productList.map((p) => (\r\n// // //               <option key={p._id} value={p.name}>{p.name}</option>\r\n// // //             ))}\r\n// // //           </select>\r\n// // //         </div>\r\n\r\n// // //         <div className=\"filter-group\">\r\n// // //           <label>üóÇÔ∏è Category:</label>\r\n// // //           <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\r\n// // //             <option value=\"\">All Categories</option>\r\n// // //             {categoryList.map((c) => (\r\n// // //               <option key={c._id} value={c.name}>{c.name}</option>\r\n// // //             ))}\r\n// // //           </select>\r\n// // //         </div>\r\n\r\n// // //         <div className=\"filter-group\">\r\n// // //           <label>üìÜ From:</label>\r\n// // //           <input type=\"date\" value={startDate} onChange={(e) => setStartDate(e.target.value)} />\r\n// // //         </div>\r\n\r\n// // //         <div className=\"filter-group\">\r\n// // //           <label>‚û° To:</label>\r\n// // //           <input type=\"date\" value={endDate} onChange={(e) => setEndDate(e.target.value)} />\r\n// // //         </div>\r\n\r\n// // //         <button className=\"btn refresh\" onClick={fetchChart}>üîÑ Apply</button>\r\n// // //       </div>\r\n\r\n// // //       {/* Chart */}\r\n// // //       <div className=\"chart-wrapper\">\r\n// // //         {loading ? (\r\n// // //           <div className=\"loading\">Loading chart...</div>\r\n// // //         ) : chartData ? (\r\n// // //           <Line\r\n// // //             data={chartData}\r\n// // //             options={{\r\n// // //               responsive: true,\r\n// // //               maintainAspectRatio: false,\r\n// // //               plugins: {\r\n// // //                 legend: { position: \"bottom\" },\r\n// // //               },\r\n// // //               scales: {\r\n// // //                 y: { beginAtZero: true },\r\n// // //               },\r\n// // //             }}\r\n// // //           />\r\n// // //         ) : (\r\n// // //           <div className=\"no-data\">No data found.</div>\r\n// // //         )}\r\n// // //       </div>\r\n// // //     </div>\r\n// // //   );\r\n// // // };\r\n\r\n// // // export default PriceAnalytics;\r\n// // import React, { useEffect, useState } from \"react\";\r\n// // import axios from \"axios\";\r\n// // import {\r\n// //   Chart as ChartJS,\r\n// //   CategoryScale,\r\n// //   LinearScale,\r\n// //   PointElement,\r\n// //   LineElement,\r\n// //   Title,\r\n// //   Tooltip,\r\n// //   Legend,\r\n// // } from \"chart.js\";\r\n// // import ChartDataLabels from \"chartjs-plugin-datalabels\";\r\n// // import { Line } from \"react-chartjs-2\";\r\n// // import \"./PriceAnalytics.css\";\r\n\r\n// // ChartJS.register(\r\n// //   CategoryScale,\r\n// //   LinearScale,\r\n// //   PointElement,\r\n// //   LineElement,\r\n// //   Title,\r\n// //   Tooltip,\r\n// //   Legend,\r\n// //   ChartDataLabels\r\n// // );\r\n\r\n// // const API_BASE = \"https://grocerrybackend.onrender.com/api\";\r\n\r\n// // const PriceAnalytics = () => {\r\n// //   const [loading, setLoading] = useState(true);\r\n// //   const [productList, setProductList] = useState([]);\r\n// //   const [categoryList, setCategoryList] = useState([]);\r\n// //   const [selectedProduct, setSelectedProduct] = useState(\"\");\r\n// //   const [selectedCategory, setSelectedCategory] = useState(\"\");\r\n// //   const [chartData, setChartData] = useState(null);\r\n\r\n// //   useEffect(() => {\r\n// //     const fetchDropdowns = async () => {\r\n// //       try {\r\n// //         const [p, c] = await Promise.all([\r\n// //           axios.get(`${API_BASE}/prices`),\r\n// //           axios.get(`${API_BASE}/categories`),\r\n// //         ]);\r\n\r\n// //         setProductList(p.data.data || []);\r\n// //         setCategoryList(c.data.categories || []);\r\n// //       } catch (err) {\r\n// //         console.error(\"Dropdown fetch error:\", err);\r\n// //       }\r\n// //     };\r\n\r\n// //     fetchDropdowns();\r\n// //   }, []);\r\n\r\n// //   const fetchChart = async () => {\r\n// //     setLoading(true);\r\n// //     try {\r\n// //       const res = await axios.get(`${API_BASE}/prices`);\r\n// //       let all = res.data.data || [];\r\n\r\n// //       // Filters\r\n// //       if (selectedProduct)\r\n// //         all = all.filter((p) => p.name === selectedProduct);\r\n\r\n// //       if (selectedCategory)\r\n// //         all = all.filter((p) => p.category?.name === selectedCategory);\r\n\r\n// //       // Group by Date\r\n// //       const grouped = {};\r\n// //       all.forEach((item) => {\r\n// //         const k = new Date(item.validTill || item.createdAt).toLocaleDateString(\"en-IN\");\r\n// //         if (!grouped[k]) grouped[k] = [];\r\n// //         grouped[k].push(item);\r\n// //       });\r\n\r\n// //       const labels = Object.keys(grouped);\r\n\r\n// //       // Final Price\r\n// //       const finalPrice = labels.map((d) => {\r\n// //         const arr = grouped[d];\r\n// //         return arr.reduce(\r\n// //           (sum, x) => sum + (Number(x.basePrice || 0) + Number(x.difference || 0)),\r\n// //           0\r\n// //         ) / arr.length;\r\n// //       });\r\n\r\n// //       setChartData({\r\n// //         labels,\r\n// //         datasets: [\r\n// //           {\r\n// //             label: \"Final Price (‚Çπ)\",\r\n// //             data: finalPrice,\r\n// //             borderColor: \"#007bff\",\r\n// //             backgroundColor: \"rgba(0,123,255,0.3)\",\r\n// //             tension: 0.3,\r\n// //           },\r\n// //         ],\r\n// //       });\r\n// //     } catch (err) {\r\n// //       console.error(\"Chart error:\", err);\r\n// //     } finally {\r\n// //       setLoading(false);\r\n// //     }\r\n// //   };\r\n\r\n// //   useEffect(() => {\r\n// //     fetchChart();\r\n// //   }, [selectedProduct, selectedCategory]);\r\n\r\n// //   return (\r\n// //     <div className=\"analytics-container\">\r\n// //       <h2 className=\"analytics-title\">üìä Final Price Analytics</h2>\r\n\r\n// //       {/* Filters */}\r\n// //       <div className=\"filter-section\">\r\n// //         <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\r\n// //           <option value=\"\">All Products</option>\r\n// //           {productList.map((p) => (\r\n// //             <option key={p._id} value={p.name}>{p.name}</option>\r\n// //           ))}\r\n// //         </select>\r\n\r\n// //         <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\r\n// //           <option value=\"\">All Categories</option>\r\n// //           {categoryList.map((c) => (\r\n// //             <option key={c._id} value={c.name}>{c.name}</option>\r\n// //           ))}\r\n// //         </select>\r\n\r\n// //         <button className=\"btn refresh\" onClick={fetchChart}>Apply</button>\r\n// //       </div>\r\n\r\n// //       {/* Chart */}\r\n// //       <div className=\"chart-wrapper\">\r\n// //         {loading ? (\r\n// //           <div className=\"loading\">Loading...</div>\r\n// //         ) : (\r\n// //           <Line\r\n// //             data={chartData}\r\n// //             options={{\r\n// //               responsive: true,\r\n// //               maintainAspectRatio: false,\r\n// //               plugins: {\r\n// //                 legend: { position: \"bottom\" },\r\n\r\n// //                 // ‚≠ê ALWAYS SHOW LABEL ‚≠ê\r\n// //                 datalabels: {\r\n// //                   color: \"#000\",\r\n// //                   anchor: \"end\",\r\n// //                   align: \"top\",\r\n// //                   formatter: (value) => `‚Çπ${value}`,\r\n// //                   font: {\r\n// //                     weight: \"bold\",\r\n// //                     size: 12,\r\n// //                   },\r\n// //                 },\r\n// //               },\r\n// //               scales: {\r\n// //                 y: { beginAtZero: true },\r\n// //               },\r\n// //             }}\r\n// //           />\r\n// //         )}\r\n// //       </div>\r\n// //     </div>\r\n// //   );\r\n// // };\r\n\r\n// // export default PriceAnalytics;\r\n\r\n// import React, { useEffect, useState } from \"react\";\r\n// import axios from \"axios\";\r\n// import {\r\n//   Chart as ChartJS,\r\n//   CategoryScale,\r\n//   LinearScale,\r\n//   PointElement,\r\n//   LineElement,\r\n//   Title,\r\n//   Tooltip,\r\n//   Legend,\r\n// } from \"chart.js\";\r\n// import ChartDataLabels from \"chartjs-plugin-datalabels\";\r\n// import { Line } from \"react-chartjs-2\";\r\n// import \"./PriceAnalytics.css\";\r\n\r\n// ChartJS.register(\r\n//   CategoryScale,\r\n//   LinearScale,\r\n//   PointElement,\r\n//   LineElement,\r\n//   Title,\r\n//   Tooltip,\r\n//   Legend,\r\n//   ChartDataLabels\r\n// );\r\n\r\n// const API_BASE = \"https://grocerrybackend.onrender.com/api\";\r\n\r\n// const PriceAnalytics = () => {\r\n//   const [loading, setLoading] = useState(true);\r\n//   const [productList, setProductList] = useState([]);\r\n//   const [categoryList, setCategoryList] = useState([]);\r\n//   const [selectedProduct, setSelectedProduct] = useState(\"\");\r\n//   const [selectedCategory, setSelectedCategory] = useState(\"\");\r\n\r\n//   // NEW FILTER STATE\r\n//   const [chartType, setChartType] = useState(\"daily\"); // daily, weekly, monthly, yearly, custom\r\n//   const [startDate, setStartDate] = useState(\"\");\r\n//   const [endDate, setEndDate] = useState(\"\");\r\n\r\n//   const [chartData, setChartData] = useState(null);\r\n\r\n//   useEffect(() => {\r\n//     const fetchDropdowns = async () => {\r\n//       try {\r\n//         const [p, c] = await Promise.all([\r\n//           axios.get(`${API_BASE}/prices`),\r\n//           axios.get(`${API_BASE}/categories`),\r\n//         ]);\r\n\r\n//         setProductList(p.data.data || []);\r\n//         setCategoryList(c.data.categories || []);\r\n//       } catch (err) {\r\n//         console.error(\"Dropdown fetch error:\", err);\r\n//       }\r\n//     };\r\n\r\n//     fetchDropdowns();\r\n//   }, []);\r\n\r\n//   // üî• GROUPING HELPERS\r\n//   const groupByWeek = (date) => {\r\n//     const d = new Date(date);\r\n//     const onejan = new Date(d.getFullYear(), 0, 1);\r\n//     const week = Math.ceil(((d - onejan) / 86400000 + onejan.getDay() + 1) / 7);\r\n//     return `Week ${week} - ${d.getFullYear()}`;\r\n//   };\r\n\r\n//   const groupByMonth = (date) => {\r\n//     const d = new Date(date);\r\n//     return `${d.toLocaleString(\"en-US\", { month: \"short\" })} ${d.getFullYear()}`;\r\n//   };\r\n\r\n//   const groupByYear = (date) => {\r\n//     return new Date(date).getFullYear().toString();\r\n//   };\r\n\r\n//   const fetchChart = async () => {\r\n//     setLoading(true);\r\n\r\n//     try {\r\n//       const res = await axios.get(`${API_BASE}/prices`);\r\n//       let all = res.data.data || [];\r\n\r\n//       // PRODUCT FILTER\r\n//       if (selectedProduct)\r\n//         all = all.filter((p) => p.name === selectedProduct);\r\n\r\n//       // CATEGORY FILTER\r\n//       if (selectedCategory)\r\n//         all = all.filter((p) => p.category?.name === selectedCategory);\r\n\r\n//       // RANGE FILTER\r\n//       if (chartType === \"custom\" && startDate && endDate) {\r\n//         const start = new Date(startDate);\r\n//         const end = new Date(endDate);\r\n//         all = all.filter((p) => {\r\n//           const d = new Date(p.validTill || p.createdAt);\r\n//           return d >= start && d <= end;\r\n//         });\r\n//       }\r\n\r\n//       // GROUP DATA\r\n//       const groups = {};\r\n\r\n//       all.forEach((item) => {\r\n//         const date = item.validTill || item.createdAt;\r\n\r\n//         let groupKey = \"\";\r\n\r\n//         switch (chartType) {\r\n//           case \"weekly\":\r\n//             groupKey = groupByWeek(date);\r\n//             break;\r\n//           case \"monthly\":\r\n//             groupKey = groupByMonth(date);\r\n//             break;\r\n//           case \"yearly\":\r\n//             groupKey = groupByYear(date);\r\n//             break;\r\n//           default:\r\n//             groupKey = new Date(date).toLocaleDateString(\"en-IN\");\r\n//         }\r\n\r\n//         if (!groups[groupKey]) groups[groupKey] = [];\r\n//         groups[groupKey].push(item);\r\n//       });\r\n\r\n//       const labels = Object.keys(groups);\r\n\r\n//       const finalPriceAvg = labels.map((d) => {\r\n//         const arr = groups[d];\r\n//         return (\r\n//           arr.reduce(\r\n//             (sum, x) =>\r\n//               sum + (Number(x.basePrice || 0) + Number(x.difference || 0)),\r\n//             0\r\n//           ) / arr.length\r\n//         );\r\n//       });\r\n\r\n//       setChartData({\r\n//         labels,\r\n//         datasets: [\r\n//           {\r\n//             label: \"Final Price (‚Çπ)\",\r\n//             data: finalPriceAvg,\r\n//             borderColor: \"#007bff\",\r\n//             backgroundColor: \"rgba(0,123,255,0.3)\",\r\n//             tension: 0.3,\r\n//           },\r\n//         ],\r\n//       });\r\n//     } catch (err) {\r\n//       console.error(\"Chart Error:\", err);\r\n//     } finally {\r\n//       setLoading(false);\r\n//     }\r\n//   };\r\n\r\n//   useEffect(() => {\r\n//     fetchChart();\r\n//   }, [selectedProduct, selectedCategory, chartType, startDate, endDate]);\r\n\r\n//   return (\r\n//     <div className=\"analytics-container\">\r\n//       <h2 className=\"analytics-title\">Price Analytics</h2>\r\n\r\n//       <div className=\"filter-section\">\r\n        \r\n//         {/* PRODUCT */}\r\n//         <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\r\n//           <option value=\"\">All Products</option>\r\n//           {productList.map((p) => (\r\n//             <option key={p._id} value={p.name}>{p.name}</option>\r\n//           ))}\r\n//         </select>\r\n\r\n//         {/* CATEGORY */}\r\n//         <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\r\n//           <option value=\"\">All Categories</option>\r\n//           {categoryList.map((c) => (\r\n//             <option key={c._id} value={c.name}>{c.name}</option>\r\n//           ))}\r\n//         </select>\r\n\r\n//         {/* TYPE FILTER */}\r\n//         <select value={chartType} onChange={(e) => setChartType(e.target.value)}>\r\n//           <option value=\"daily\">Daily</option>\r\n//           <option value=\"weekly\">Weekly</option>\r\n//           <option value=\"monthly\">Monthly</option>\r\n//           <option value=\"yearly\">Yearly</option>\r\n//           {/* <option value=\"custom\">Custom Range</option> */}\r\n//         </select>\r\n\r\n//         {/* DATE RANGE ONLY IF CUSTOM */}\r\n//         {chartType === \"custom\" && (\r\n//           <>\r\n//             <input type=\"date\" value={startDate} onChange={(e) => setStartDate(e.target.value)} />\r\n//             <input type=\"date\" value={endDate} onChange={(e) => setEndDate(e.target.value)} />\r\n//           </>\r\n//         )}\r\n\r\n//         {/* <button className=\"btn refresh\" onClick={fetchChart}>Apply</button> */}\r\n//       </div>\r\n\r\n//       <div className=\"chart-wrapper\">\r\n//         {loading ? (\r\n//           <div className=\"loading\">Loading chart...</div>\r\n//         ) : (\r\n//           <Line\r\n//             data={chartData}\r\n//             options={{\r\n//               responsive: true,\r\n//               maintainAspectRatio: false,\r\n//               plugins: {\r\n//                 legend: { position: \"bottom\" },\r\n//                 datalabels: {\r\n//                   color: \"black\",\r\n//                   anchor: \"end\",\r\n//                   align: \"top\",\r\n//                   formatter: (v) => `‚Çπ${v}`,\r\n//                   font: { size: 12, weight: \"bold\" },\r\n//                 },\r\n//               },\r\n//             }}\r\n//           />\r\n//         )}\r\n//       </div>\r\n//     </div>\r\n//   );\r\n// };\r\n\r\n// export default PriceAnalytics;\r\n\r\nimport React, { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport {\r\n  Chart as ChartJS,\r\n  CategoryScale,\r\n  LinearScale,\r\n  PointElement,\r\n  LineElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend,\r\n} from \"chart.js\";\r\nimport ChartDataLabels from \"chartjs-plugin-datalabels\";\r\nimport { Line } from \"react-chartjs-2\";\r\nimport \"./PriceAnalytics.css\";\r\n\r\nChartJS.register(\r\n  CategoryScale,\r\n  LinearScale,\r\n  PointElement,\r\n  LineElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend,\r\n  ChartDataLabels\r\n);\r\n\r\nconst API_BASE = \"https://grocerrybackend.onrender.com/api\";\r\n\r\nexport default function PriceAnalytics() {\r\n  const [loading, setLoading] = useState(true);\r\n  const [productList, setProductList] = useState([]);\r\n  const [categoryList, setCategoryList] = useState([]);\r\n  const [selectedProduct, setSelectedProduct] = useState(\"\");\r\n  const [selectedCategory, setSelectedCategory] = useState(\"\");\r\n  const [chartType, setChartType] = useState(\"daily\");\r\n  const [chartData, setChartData] = useState(null);\r\n\r\n  /* ================= FETCH DROPDOWNS ================= */\r\n  useEffect(() => {\r\n    const fetchDropdowns = async () => {\r\n      try {\r\n        const [p, c] = await Promise.all([\r\n          axios.get(`${API_BASE}/prices`),\r\n          axios.get(`${API_BASE}/categories`),\r\n        ]);\r\n\r\n        setProductList(p.data.data || []);\r\n        setCategoryList(c.data.categories || []);\r\n      } catch (e) {\r\n        console.error(e);\r\n      }\r\n    };\r\n    fetchDropdowns();\r\n  }, []);\r\n\r\n  /* ================= GROUP HELPERS ================= */\r\n  const groupByWeek = (date) => {\r\n    const d = new Date(date);\r\n    const onejan = new Date(d.getFullYear(), 0, 1);\r\n    const week = Math.ceil(((d - onejan) / 86400000 + onejan.getDay() + 1) / 7);\r\n    return `Week ${week}`;\r\n  };\r\n\r\n  const groupByMonth = (date) =>\r\n    new Date(date).toLocaleString(\"en-IN\", { month: \"short\", year: \"numeric\" });\r\n\r\n  const groupByYear = (date) => new Date(date).getFullYear().toString();\r\n\r\n  /* ================= FETCH & BUILD CHART ================= */\r\n  const fetchChart = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const res = await axios.get(`${API_BASE}/prices`);\r\n      let data = res.data.data || [];\r\n\r\n      if (selectedProduct)\r\n        data = data.filter((p) => p.name === selectedProduct);\r\n\r\n      if (selectedCategory)\r\n        data = data.filter((p) => p.category?.name === selectedCategory);\r\n\r\n      const groups = {};\r\n\r\n      data.forEach((item) => {\r\n        const date = item.validTill || item.createdAt;\r\n        let key = \"\";\r\n\r\n        if (chartType === \"weekly\") key = groupByWeek(date);\r\n        else if (chartType === \"monthly\") key = groupByMonth(date);\r\n        else if (chartType === \"yearly\") key = groupByYear(date);\r\n        else key = new Date(date).toLocaleDateString(\"en-IN\");\r\n\r\n        if (!groups[key]) groups[key] = [];\r\n        groups[key].push(item);\r\n      });\r\n\r\n      const labels = Object.keys(groups).sort();\r\n\r\n      if (labels.length === 0) {\r\n        setChartData(null);\r\n        return;\r\n      }\r\n\r\n      const prices = labels.map((label) => {\r\n        const arr = groups[label];\r\n        const total = arr.reduce((sum, x) => {\r\n          const base = Number(x.basePrice) || 0;\r\n          const diff = Number(x.difference) || 0;\r\n          return sum + base + diff;\r\n        }, 0);\r\n        return Number((total / arr.length).toFixed(2));\r\n      });\r\n\r\n      setChartData({\r\n        labels,\r\n        datasets: [\r\n          {\r\n            label: \"Final Price (‚Çπ)\",\r\n            data: prices,\r\n            borderColor: \"#dc3545\",\r\n            backgroundColor: \"rgba(220,53,69,0.25)\",\r\n            tension: 0.4,\r\n            fill: true,\r\n            pointRadius: 4,\r\n            pointBackgroundColor: \"#dc3545\",\r\n          },\r\n        ],\r\n      });\r\n    } catch (e) {\r\n      console.error(\"Chart error:\", e);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchChart();\r\n  }, [selectedProduct, selectedCategory, chartType]);\r\n\r\n  /* ================= UI ================= */\r\n  return (\r\n    <div className=\"analytics-container\">\r\n      <h2 className=\"analytics-title\">Price Analytics</h2>\r\n\r\n      <div className=\"filter-section\">\r\n        <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\r\n          <option value=\"\">All Products</option>\r\n          {productList.map((p) => (\r\n            <option key={p._id} value={p.name}>{p.name}</option>\r\n          ))}\r\n        </select>\r\n\r\n        <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\r\n          <option value=\"\">All Categories</option>\r\n          {categoryList.map((c) => (\r\n            <option key={c._id} value={c.name}>{c.name}</option>\r\n          ))}\r\n        </select>\r\n\r\n        <select value={chartType} onChange={(e) => setChartType(e.target.value)}>\r\n          <option value=\"daily\">Daily</option>\r\n          <option value=\"weekly\">Weekly</option>\r\n          <option value=\"monthly\">Monthly</option>\r\n          <option value=\"yearly\">Yearly</option>\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"chart-wrapper\">\r\n        {loading ? (\r\n          <div className=\"loading\">Loading chart...</div>\r\n        ) : chartData ? (\r\n          <Line\r\n            data={chartData}\r\n            options={{\r\n              responsive: true,\r\n              maintainAspectRatio: false,\r\n              plugins: {\r\n                legend: { position: \"bottom\" },\r\n                datalabels: {\r\n                  display: true,\r\n                  color: \"#000\",\r\n                  align: \"top\",\r\n                  formatter: (v) => `‚Çπ${v}`,\r\n                },\r\n              },\r\n              scales: {\r\n                y: { beginAtZero: true },\r\n              },\r\n            }}\r\n          />\r\n        ) : (\r\n          <div className=\"no-data\">No data available</div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":";;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAE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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}