import { getPath } from '../_internal/getPath.mjs';

function orderBy(collection, keys, orders) {
    if (collection == null) {
        return [];
    }
    if (!Array.isArray(keys)) {
        keys = keys == null ? [] : [keys];
    }
    if (!Array.isArray(orders)) {
        orders = orders == null ? [] : [orders];
    }
    const compareValues = (a, b, order) => {
        if (a < b) {
            return order === 'desc' ? 1 : -1;
        }
        if (a > b) {
            return order === 'desc' ? -1 : 1;
        }
        return 0;
    };
    const getValueByPath = (key, obj) => {
        if (Array.isArray(key)) {
            let value = obj;
            for (let i = 0; i < key.length; i++) {
                value = value[key[i]];
            }
            return value;
        }
        return obj[key];
    };
    keys = keys.map(key => getPath(key, collection[0]));
    const shallowCopiedCollection = collection.slice();
    const orderedCollection = shallowCopiedCollection.sort((a, b) => {
        for (let i = 0; i < keys.length; i++) {
            const key = keys[i];
            const valueA = getValueByPath(key, a);
            const valueB = getValueByPath(key, b);
            const order = String(orders[i]);
            const comparedResult = compareValues(valueA, valueB, order);
            if (comparedResult !== 0) {
                return comparedResult;
            }
        }
        return 0;
    });
    return orderedCollection;
}

export { orderBy };
